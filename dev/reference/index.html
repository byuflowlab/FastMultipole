<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · FastMultipole.jl</title><meta name="title" content="Reference · FastMultipole.jl"/><meta property="og:title" content="Reference · FastMultipole.jl"/><meta property="twitter:title" content="Reference · FastMultipole.jl"/><meta name="description" content="Documentation for FastMultipole.jl."/><meta property="og:description" content="Documentation for FastMultipole.jl."/><meta property="twitter:description" content="Documentation for FastMultipole.jl."/><meta property="og:url" content="https://flow.byu.edu/FastMultipole/reference/"/><meta property="twitter:url" content="https://flow.byu.edu/FastMultipole/reference/"/><link rel="canonical" href="https://flow.byu.edu/FastMultipole/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FastMultipole.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../guided_examples/">Gravitational Example</a></li><li><a class="tocitem" href="../vortex_filament/">Vortex Filament Example</a></li><li><a class="tocitem" href="../tuning/">Tuning Parameters</a></li><li><a class="tocitem" href="../advanced_usage/">Multiple Systems</a></li><li><a class="tocitem" href="../advanced_usage_2/">Automated Tuning</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#FastMultipole.Branch"><code>FastMultipole.Branch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.ExpansionSwitch"><code>FastMultipole.ExpansionSwitch</code></a></li><li><a href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a></li><li><a href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a></li><li><a href="#FastMultipole.TreeByLevel"><code>FastMultipole.TreeByLevel</code></a></li><li><a href="#FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH"><code>FastMultipole._rotate_multipole_y_n!</code></a></li><li><a href="#FastMultipole.allocate_buffers-Tuple{Tuple, Bool, Any}"><code>FastMultipole.allocate_buffers</code></a></li><li><a href="#FastMultipole.allocate_small_buffers-Tuple{Tuple, Any}"><code>FastMultipole.allocate_small_buffers</code></a></li><li><a href="#FastMultipole.back_rotate_local_y!-NTuple{7, Any}"><code>FastMultipole.back_rotate_local_y!</code></a></li><li><a href="#FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}"><code>FastMultipole.back_rotate_multipole_y!</code></a></li><li><a href="#FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.back_rotate_z!</code></a></li><li><a href="#FastMultipole.body_to_multipole!-NTuple{7, Any}"><code>FastMultipole.body_to_multipole!</code></a></li><li><a href="#FastMultipole.buffer_to_system_strength!-NTuple{4, Any}"><code>FastMultipole.buffer_to_system_strength!</code></a></li><li><a href="#FastMultipole.buffer_to_target_system!-NTuple{5, Any}"><code>FastMultipole.buffer_to_target_system!</code></a></li><li><a href="#FastMultipole.calculate_ib!-NTuple{7, Any}"><code>FastMultipole.calculate_ib!</code></a></li><li><a href="#FastMultipole.calculate_pj!-NTuple{7, Any}"><code>FastMultipole.calculate_pj!</code></a></li><li><a href="#FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}"><code>FastMultipole.closest_corner</code></a></li><li><a href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a></li><li><a href="#FastMultipole.data_per_body-Tuple{Any}"><code>FastMultipole.data_per_body</code></a></li><li><a href="#FastMultipole.direct!-NTuple{6, Any}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a></li><li><a href="#FastMultipole.fmm!"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.get_n_bodies-Tuple{Any}"><code>FastMultipole.get_n_bodies</code></a></li><li><a href="#FastMultipole.get_normal-Tuple{Any, Any, Any}"><code>FastMultipole.get_normal</code></a></li><li><a href="#FastMultipole.get_position-Tuple{Any, Any}"><code>FastMultipole.get_position</code></a></li><li><a href="#FastMultipole.index_by_source-Tuple{Vector{StaticArraysCore.SVector{2, Int32}}, Vector{Int64}}"><code>FastMultipole.index_by_source</code></a></li><li><a href="#FastMultipole.influence!-Union{Tuple{TF}, Tuple{Vector{TF}, Array{Vector{TF}, 1}, Tuple, Tuple, Tuple, Tree}} where TF"><code>FastMultipole.influence!</code></a></li><li><a href="#FastMultipole.influence!-NTuple{4, Any}"><code>FastMultipole.influence!</code></a></li><li><a href="#FastMultipole.local_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.local_error</code></a></li><li><a href="#FastMultipole.local_power-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_power</code></a></li><li><a href="#FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_to_local!</code></a></li><li><a href="#FastMultipole.make_direct_assignments!-NTuple{9, Any}"><code>FastMultipole.make_direct_assignments!</code></a></li><li><a href="#FastMultipole.map_by_branch-Tuple{Tree}"><code>FastMultipole.map_by_branch</code></a></li><li><a href="#FastMultipole.map_by_leaf-Tuple{Tree}"><code>FastMultipole.map_by_leaf</code></a></li><li><a href="#FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}"><code>FastMultipole.mirrored_source_to_vortex!</code></a></li><li><a href="#FastMultipole.multipole_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.multipole_error</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, RotatedCoefficientsAbsoluteGradient{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-NTuple{16, Any}"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsoluteGradient{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}"><code>FastMultipole.nearfield_device!</code></a></li><li><a href="#FastMultipole.nearfield_device!-Tuple{Any, Any, Any}"><code>FastMultipole.nearfield_device!</code></a></li><li><a href="#FastMultipole.predict_error-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential}} where LH"><code>FastMultipole.predict_error</code></a></li><li><a href="#FastMultipole.rotate_multipole_y!-NTuple{8, Any}"><code>FastMultipole.rotate_multipole_y!</code></a></li><li><a href="#FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.rotate_z!</code></a></li><li><a href="#FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n!</code></a></li><li><a href="#FastMultipole.rotate_z_n_power!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n_power!</code></a></li><li><a href="#FastMultipole.self_influence_matrices-Union{Tuple{TF}, Tuple{Any, Any, Any, Tree{TF}, Any, Any}} where TF"><code>FastMultipole.self_influence_matrices</code></a></li><li><a href="#FastMultipole.set_gradient!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_gradient!</code></a></li><li><a href="#FastMultipole.set_hessian!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_hessian!</code></a></li><li><a href="#FastMultipole.set_scalar_potential!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_scalar_potential!</code></a></li><li><a href="#FastMultipole.shrink_branch!-Tuple{Any, Any, Any}"><code>FastMultipole.shrink_branch!</code></a></li><li><a href="#FastMultipole.source_system_to_buffer!-NTuple{4, Any}"><code>FastMultipole.source_system_to_buffer!</code></a></li><li><a href="#FastMultipole.source_to_dipole!-NTuple{7, Any}"><code>FastMultipole.source_to_dipole!</code></a></li><li><a href="#FastMultipole.source_to_vortex_point!-NTuple{7, Any}"><code>FastMultipole.source_to_vortex_point!</code></a></li><li><a href="#FastMultipole.strength_dims-Tuple{Any}"><code>FastMultipole.strength_dims</code></a></li><li><a href="#FastMultipole.strength_to_value-Tuple{Any, Any}"><code>FastMultipole.strength_to_value</code></a></li><li><a href="#FastMultipole.target_influence_to_buffer!-NTuple{5, Any}"><code>FastMultipole.target_influence_to_buffer!</code></a></li><li><a href="#FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_local_z!</code></a></li><li><a href="#FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z!</code></a></li><li><a href="#FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH"><code>FastMultipole.translate_multipole_to_local_z_m01_n</code></a></li><li><a href="#FastMultipole.translate_multipole_to_local_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z_n!</code></a></li><li><a href="#FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_z!</code></a></li><li><a href="#FastMultipole.tune_fmm-Tuple{Tuple, Tuple}"><code>FastMultipole.tune_fmm</code></a></li><li><a href="#FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF"><code>FastMultipole.update_Ts_0!</code></a></li><li><a href="#FastMultipole.update_eimϕs_0!-Tuple{Any, Any}"><code>FastMultipole.update_eimϕs_0!</code></a></li><li><a href="#FastMultipole.update_eimϕs_n!-NTuple{6, Any}"><code>FastMultipole.update_eimϕs_n!</code></a></li><li><a href="#FastMultipole.update_nonself_influence!-Tuple{Any, Vector, FastMultipole.Matrices, Vector, Tree, Tree, Vector{UnitRange{Int64}}, Vector{UnitRange{Int64}}, Vector{StaticArraysCore.SVector{2, Int32}}, Vector{UnitRange{Int64}}}"><code>FastMultipole.update_nonself_influence!</code></a></li><li><a href="#FastMultipole.value_to_strength!-NTuple{4, Any}"><code>FastMultipole.value_to_strength!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.Branch" href="#FastMultipole.Branch"><code>FastMultipole.Branch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Branch{TF,N}</code></pre><p>Branch object used to sort more than one system into an octree. Type parameters represent:</p><ul><li><code>TF</code>: the floating point type (would be a dual number if using algorithmic differentiation)</li><li><code>N</code>: the number of systems represented</li></ul><p><strong>Fields</strong></p><ul><li><code>bodies_index::Vector{UnitRange}</code>: vector of unit ranges indicating the index of bodies in each represented system, respectively</li><li><code>n_branches::Int</code>: number of child branches corresponding to this branch</li><li><code>branch_index::UnitRange</code>: indices of this branch&#39;s child branches</li><li><code>i_parent::Int</code>: index of this branch&#39;s parent</li><li><code>i_leaf::Int</code>: if this branch is a leaf, what is its index in its parent <code>&lt;:Tree</code>&#39;s <code>leaf_index</code> field</li><li><code>center::Vector{TF}</code>: center of this branch at which its multipole and local expansions are centered</li><li><code>source_radius::TF</code>: if this branch is a leaf, distance from <code>center</code> to the outer edge of farthest body contained in this branch; otherwise, this is the distance from <code>center</code> to the corner of its <code>source_box</code></li><li><code>target_radius::TF</code>: distance from <code>center</code> to the farthest body center contained in this branch</li><li><code>source_box::Vector{TF}</code>: vector of length 6 containing the distances from the center to faces of a rectangular prism completely enclosing all bodies with their finite radius in the negative x, positive x, negative y, positive y, negative z, and positive z directions, respectively</li><li><code>target_box::Vector{TF}</code>: vector of length 3 containing the distances from the center to faces of a rectangular prism completely enclosing all body centers in the x, y, and z direction, respectively</li><li><code>max_influence::TF</code>: maximum influence of any body in this branch on any body in its child branches; used to enforce a relative error tolerance</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/containers.jl#L127-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch" href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch</code></pre><p>Switch indicating whether the scalar potential, vector potential, gradient, and/or hessian should be computed for a target system. Information is stored as type parameters, allowing the compiler to compile away if statements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/containers.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}" href="#FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, gradient, hessian)</code></pre><p>Constructs a tuple of <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>gradient::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the vector field should be computed for each target system</li><li><code>hessian::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the vector gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/derivativesswitch.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}" href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, gradient, hessian, target_systems)</code></pre><p>Constructs a <code>::Tuple</code> of indentical <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects of the same length as <code>target_systems</code> (if it is a <code>::Tuple</code>), or a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> (if <code>target_system</code> is not a <code>::Tuple</code>)</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>gradient::Bool</code>: a <code>::Bool</code> indicating whether the vector field should be computed for each target system</li><li><code>hessian::Bool</code>: a <code>::Bool</code> indicating whether the vector gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/derivativesswitch.jl#L33-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}" href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, gradient, hessian)</code></pre><p>Constructs a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> object.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for the target system</li><li><code>gradient::Bool</code>: a <code>::Bool</code> indicating whether the vector field should be computed for the target system</li><li><code>hessian::Bool</code>: a <code>::Bool</code> indicating whether the vector gradient should be computed for the target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/derivativesswitch.jl#L17-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ExpansionSwitch" href="#FastMultipole.ExpansionSwitch"><code>FastMultipole.ExpansionSwitch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExpansionSwitch</code></pre><p>Switch indicating which expansions should be used:</p><ol><li>scalar potential (<code>SP</code>)</li><li>vector potential via Lamb-Helmholtz decomposition (<code>VP</code>)</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/containers.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem" href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem</code></pre><p>Convenience system for defining locations at which the potential, vector field, or vector gradient may be desired.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/containers.jl#L218-L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.Tree" href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bodies[index<em>list] is the same sort operation as performed by the tree sorted</em>bodies[inverse<em>index</em>list] undoes the sort operation performed by the tree</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/containers.jl#L178-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.EmptyTree-Tuple{Any}" href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmptyTree(system)</code></pre><p>Returns an empty tree. Used if <code>system</code> is empty.</p><p><strong>Arguments</strong></p><ul><li><code>system</code>: the system from which a tree is to be created</li></ul><p><strong>Returns</strong></p><ul><li><code>tree</code>: if <code>typeof(system)&lt;:Tuple</code>, a <code>::MultiTree</code> is returned; otherwise, a <code>::SingleTree</code> is returned</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/tree.jl#L128-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.TreeByLevel" href="#FastMultipole.TreeByLevel"><code>FastMultipole.TreeByLevel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Doesn&#39;t stop subdividing until ALL child branches have satisfied the leaf size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/tree.jl#L172-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH" href="#FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH"><code>FastMultipole._rotate_multipole_y_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The first time this function is called, it should receive i<em>ζ=0, i</em>T=0, and n=0. It will return i<em>ζ and i</em>T appropriate for n+1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L805-L807">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.allocate_buffers-Tuple{Tuple, Bool, Any}" href="#FastMultipole.allocate_buffers-Tuple{Tuple, Bool, Any}"><code>FastMultipole.allocate_buffers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">allocate_buffers(systems::Tuple, target::Bool)</code></pre><p>Allocates buffers for the given systems. If <code>target</code> is <code>true</code>, it allocates space for position, scalar potential, gradient, and hessian matrix. Otherwise, it allocates enough memory for the user-defined <code>source_system_to_buffer!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/tree.jl#L302-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.allocate_small_buffers-Tuple{Tuple, Any}" href="#FastMultipole.allocate_small_buffers-Tuple{Tuple, Any}"><code>FastMultipole.allocate_small_buffers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">allocate_small_buffers(systems::Tuple; target=false)</code></pre><p>Allocates small buffers for the given systems. These buffers are used for temporary storage of body positions for octree sorting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/tree.jl#L318-L322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_local_y!-NTuple{7, Any}" href="#FastMultipole.back_rotate_local_y!-NTuple{7, Any}"><code>FastMultipole.back_rotate_local_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes Ts, Hs<em>π2, and ηs</em>mag have all been precomputed. Resets target_weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L1123-L1125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}" href="#FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}"><code>FastMultipole.back_rotate_multipole_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes Ts, Hs<em>π2, and ζs</em>mag have all been precomputed. Resets target_weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L924-L926">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.back_rotate_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes eimϕs have already been computed. DOES NOT overwrite rotated weights (unlike other rotate functions); rather, accumulates on top of it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L581-L583">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.body_to_multipole!-NTuple{7, Any}" href="#FastMultipole.body_to_multipole!-NTuple{7, Any}"><code>FastMultipole.body_to_multipole!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">body_to_multipole!(system::{UserDefinedSystem}, multipole_coefficients, buffer, expansion_center, bodies_index, harmonics, expansion_order)</code></pre><p>Calculates the multipole coefficients due to the bodies contained in <code>buffer[:,bodies_index]</code> and accumulates them in <code>multipole_coefficients</code>. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system).</p><p>Typically, this is done using one of the convience functions contained within FastMultipole in one line, as</p><pre><code class="language-julia hljs">body_to_multipole!(system::MySystem, args...) = body_to_multipole!(Point{Vortex}, system, args...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L81-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.buffer_to_system_strength!-NTuple{4, Any}" href="#FastMultipole.buffer_to_system_strength!-NTuple{4, Any}"><code>FastMultipole.buffer_to_system_strength!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">buffer_to_system_strength!(system::{UserDefinedSystem}, source_buffer::Matrix{Float64}, i_body::Int)</code></pre><p><strong>NOTE:</strong> this function is primarily used for the boundary element solver, and is not required for the FMM.</p><p>Updates the strength in <code>system</code> for the <code>i_body</code>th body using the strength information contained in <code>source_buffer</code>. Should be overloaded for each user-defined system object used with the boundary element solver.</p><p><strong>Arguments:</strong></p><ul><li><code>system::{UserDefinedSystem}</code>: the user-defined system object</li><li><code>i_body::Int</code>: the index of the body in <code>source_system</code> whose strength is to be set</li><li><code>source_buffer::Matrix{Float64}</code>: the source buffer containing the body information</li><li><code>i_buffer::Int</code>: the index of the body in <code>source_buffer</code> whose strength is to be set</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L244-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.buffer_to_target_system!-NTuple{5, Any}" href="#FastMultipole.buffer_to_target_system!-NTuple{5, Any}"><code>FastMultipole.buffer_to_target_system!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">buffer_to_target_system!(target_system::{UserDefinedSystem}, i_target, ::DerivativesSwitch{PS,GS,HS}, target_buffer, i_buffer) where {PS,GS,HS}</code></pre><p>Compatibility function used to update target systems. It should be overloaded for each system (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system) to be a target and should behave as follows. For the <code>i_body</code>th body contained inside of <code>target_system</code>,</p><ul><li><code>target_buffer[4, i_buffer]</code> contains the scalar potential influence to be added to the <code>i_target</code> body of <code>target_system</code></li><li><code>target_buffer[5:7, i_buffer]</code> contains the vector field influence to be added to the <code>i_target</code> body of <code>target_system</code></li><li><code>target_buffer[8:16, i_buffer]</code> contains the vector field gradient to be added to the <code>i_target</code> body of <code>target_system</code></li></ul><p>Note that any system acting only as a source (and not as a target) need not overload <code>buffer_to_target_system!</code>.</p><p>The following convenience functions can may be used to access the buffer:</p><ul><li><code>get_scalar_potential(target_buffer, i_buffer::Int)</code>: returns the scalar potential induced at the <code>i_buffer</code> body in <code>target_buffer</code></li><li><code>get_gradient(target_buffer, i_buffer::Int)</code>: returns an SVector of length 3 containing the vector field induced at the <code>i_buffer</code> body in <code>target_buffer</code></li><li><code>get_hessian(target_buffer, i_buffer::Int)</code>: returns an SMatrix of size 3x3 containing the vector gradient induced at the <code>i_buffer</code> body in <code>target_buffer</code></li></ul><p>For some slight performance improvements, the booleans <code>PS</code>, <code>GS</code>, and <code>HS</code> can be used as a switch to indicate whether the scalar potential, vector field, and vector gradient are to be stored, respectively. Since they are compile-time parameters, <code>if</code> statements relying on them will not incur a runtime cost.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L154-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.calculate_ib!-NTuple{7, Any}" href="#FastMultipole.calculate_ib!-NTuple{7, Any}"><code>FastMultipole.calculate_ib!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes j has already been calculated</p><p>Note: if X0<em>real is replaced with X0</em>real + Xw_real, etc., this becomes bnm (as used for volumes) instead of inm (as used for panels)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/bodytomultipole.jl#L178-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.calculate_pj!-NTuple{7, Any}" href="#FastMultipole.calculate_pj!-NTuple{7, Any}"><code>FastMultipole.calculate_pj!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes q has already been calculated</p><p>If X0<em>real is replaced with X0</em>real + Xv_real, etc., the result becomes jnm instead of pnm, as used for panels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/bodytomultipole.jl#L141-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}" href="#FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}"><code>FastMultipole.closest_corner</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Vector from center 2 to the corner of box2 closest to center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/error.jl#L22-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.d2rdx2-Tuple{Any, Any, Any}" href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>k/dx</em>idx_j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/derivatives.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.data_per_body-Tuple{Any}" href="#FastMultipole.data_per_body-Tuple{Any}"><code>FastMultipole.data_per_body</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">data_per_body(system::{UserDefinedSystem})</code></pre><p>Returns the number of values used to represent a single body in a source system. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L25-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-NTuple{6, Any}" href="#FastMultipole.direct!-NTuple{6, Any}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(target_buffer, target_index, derivatives_switch::DerivativesSwitch{PS,GS,HS}, ::{UserDefinedSystem}, source_buffer, source_index) where {PS,GS,HS}</code></pre><p>Calculates direct (nearfield) interactions of <code>source_system</code> on <code>target_buffer</code>. Should be overloaded or each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system), for all source bodies in <code>source_index</code>, at all target bodies in <code>target_index</code>, as follows:</p><pre><code class="language-julia hljs"># loop over source bodies
for i_source in source_index

    # extract source body information here...

    # loop over target bodies
    for i_target in target_index

        # get target position
        target_position = get_position(target_buffer, i_target)

        # evaluate influence here...

        # update appropriate quantities
        if PS
            set_scalar_potential!(target_buffer, i_target, scalar_potential)
        end
        if GS
            set_gradient!(target_buffer, i_target, gradient)
        end
        if HS
            set_hessian!(target_buffer, i_target, hessian)
        end

    end
end</code></pre><p>Note that <code>::{UserDefinedSystem}</code> is used purely for overloading the method for the appropriate system, and should NOT be accessed in this function, since it will NOT be indexed according to <code>source_index</code>. Rather, <code>source_buffer</code>, which is updated using <code>source_system_to_buffer!</code>, should be accessed.</p><p>The following convenience getter functions are available for accessing the source system:</p><ul><li><code>get_position(source_system::{UserDefinedSystem}, i_body::Int)</code>: returns an SVector of length 3 containing the position of the <code>i_body</code> body</li><li><code>get_strength(source_buffer::Matrix, source_system::{UserDefinedSystem}, i_body::Int)</code>: returns an SVector containing the strength of the <code>i_body</code> body</li><li><code>get_vertex(source_buffer::Matrix, source_system::{UserDefinedSystem}, i_body::Int, i_vertex::Int)</code>: returns an SVector containing the x, y, and z coordinates of the <code>i_vertex</code> vertex of the <code>i_body</code> body</li></ul><p>Note also that the compile time parameters <code>PS</code>, <code>GS</code>, and <code>HS</code> are used to determine whether the scalar potential and vector field should be computed, respectively. This allows us to skip unnecessary calculations and improve performance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L101-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-Tuple{Tuple}" href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(systems; derivatives_switches)</code></pre><p>Applies all interactions of <code>systems</code> acting on itself without multipole acceleration.</p><p><strong>Arguments</strong></p><ul><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector field from <code>source_systems</code></li><li><code>hessian::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector gradient from <code>source_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/direct.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.drdx-Tuple{Any, Any, Any}" href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>j/dx</em>i</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/derivatives.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!" href="#FastMultipole.fmm!"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_systems::Tuple, source_systems::Tuple; optargs...)</code></pre><p>Dispatches <code>fmm!</code> with automatic tree creation.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems::Union{Tuple, {UserDefinedSystem}}</code>: either a system object for which compatibility functions have been overloaded, or a tuple of system objects for which compatibility functions have been overloaded</li><li><code>source_systems::Union{Tuple, {UserDefinedSystem}}</code>: either a system object for which compatibility functions have been overloaded, or a tuple of system objects for which compatibility functions have been overloaded</li></ul><p>Note: a convenience function <code>fmm!(system)</code> is provided, which is equivalent to <code>fmm!(system, system)</code>. This is for situations where all system(s) act on all other systems, including themselves.</p><p><strong>Optional Arguments: Allocation</strong></p><ul><li><code>target_buffers::Vector{&lt;:Any}</code>: buffers for target systems; if not provided, buffers are allocated using <a href="#FastMultipole.allocate_buffers-Tuple{Tuple, Bool, Any}"><code>allocate_buffers</code></a></li><li><code>target_small_buffers::Vector{&lt;:Any}</code>: small buffers for target systems; if not provided, small buffers are allocated using <a href="#FastMultipole.allocate_small_buffers-Tuple{Tuple, Any}"><code>allocate_small_buffers</code></a></li><li><code>source_buffers::Vector{&lt;:Any}</code>: buffers for source systems; if not provided, buffers are allocated using <a href="#FastMultipole.allocate_buffers-Tuple{Tuple, Bool, Any}"><code>allocate_buffers</code></a></li><li><code>source_small_buffers::Vector{&lt;:Any}</code>: small buffers for source systems; if not provided, small buffers are allocated using <a href="#FastMultipole.allocate_small_buffers-Tuple{Tuple, Any}"><code>allocate_small_buffers</code></a></li></ul><p><strong>Optional Arguments: Tuning Parameters</strong></p><ul><li><code>expansion_order::Int</code>: order of multipole expansions; default is 5</li><li><code>multipole_acceptance::Float64</code>: acceptance criterion for multipole expansions; default is 0.4</li><li><code>leaf_size_target::Union{Nothing,Int}</code>: leaf size for target systems; if not provided, the minimum of the source leaf sizes is used</li><li><code>leaf_size_source::Union{Nothing,Int}</code>: leaf size for source systems; if not provided, the default leaf size is used</li><li><code>ε_tol::Union{Nothing,ErrorMethod}</code>: error tolerance for multipole to local translations; if not provided, no error treatment is performed</li></ul><p><strong>Optional Arguments: Tree Options</strong></p><ul><li><code>shrink_recenter::Bool</code>: whether to shrink and recenter branches around their bodies, accounting for finite body radius; default is <code>true</code></li><li><code>interaction_list_method::InteractionListMethod</code>: method for building interaction lists; default is <code>SelfTuningTreeStop()</code></li></ul><p><strong>Optional Arguments: Additional Options</strong></p><ul><li><code>farfield::Bool</code>: whether to compute farfield interactions; default is <code>true</code></li><li><code>nearfield::Bool</code>: whether to compute nearfield interactions; default is <code>true</code></li><li><code>self_induced::Bool</code>: whether to compute self-induced interactions; default is <code>true</code></li><li><code>upward_pass::Bool</code>: whether to perform the upward pass; default is <code>true</code></li><li><code>horizontal_pass::Bool</code>: whether to perform the horizontal pass; default is <code>true</code></li><li><code>downward_pass::Bool</code>: whether to perform the downward pass; default is <code>true</code></li><li><code>scalar_potential::Union{Bool,AbstractVector{Bool}}</code>: whether to compute the scalar potential; default is <code>false</code></li><li><code>gradient::Union{Bool,AbstractVector{Bool}}</code>: whether to compute the vector field; default is <code>true</code></li><li><code>hessian::Union{Bool,AbstractVector{Bool}}</code>: whether to compute the vector gradient; default is <code>false</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/fmm.jl#L817-L861">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.get_n_bodies-Tuple{Any}" href="#FastMultipole.get_n_bodies-Tuple{Any}"><code>FastMultipole.get_n_bodies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_n_bodies(system::{UserDefinedSystem})</code></pre><p>Returns the number of bodies contained inside <code>system</code>. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.get_normal-Tuple{Any, Any, Any}" href="#FastMultipole.get_normal-Tuple{Any, Any, Any}"><code>FastMultipole.get_normal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_normal(source_buffer, source_system::{UserDefinedSystem}, i)</code></pre><p><strong>OPTIONAL OVERLOAD:</strong></p><p>Returns the unit normal vector for the <code>i</code>th body of <code>source_buffer</code>. May be (optionally) overloaded for a user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system); otherwise, the default behavior assumes counter-clockwise ordered vertices. Note that whatever method is used should match <code>source_system_to_buffer!</code> for each system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L57-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.get_position-Tuple{Any, Any}" href="#FastMultipole.get_position-Tuple{Any, Any}"><code>FastMultipole.get_position</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_position(system::{UserDefinedSystem}, i)</code></pre><p>Returns a (static) vector of length 3 containing the x, y, and z coordinates of the position of the <code>i</code>th body. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.index_by_source-Tuple{Vector{StaticArraysCore.SVector{2, Int32}}, Vector{Int64}}" href="#FastMultipole.index_by_source-Tuple{Vector{StaticArraysCore.SVector{2, Int32}}, Vector{Int64}}"><code>FastMultipole.index_by_source</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">index_by_source(sorted_list::Vector{SVector{2,Int}}, leaf_index::Vector{Int})</code></pre><p>Constructs an index map that maps each leaf to the range of indices in the sorted list where it acts as a source. It is possible for some leaves to never act as sources, in which case the range will be empty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L287-L291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.influence!-NTuple{4, Any}" href="#FastMultipole.influence!-NTuple{4, Any}"><code>FastMultipole.influence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">influence!(influence, target_buffer, source_system, source_buffer)</code></pre><p><strong>NOTE:</strong> <code>source_system</code> is provided solely for dispatch; it&#39;s member bodies will be out of order and should not be referenced.</p><p><strong>NOTE:</strong> This function is primarily used for the boundary element solver, and is not required for the FMM.</p><p>Evaluate the influence as pertains to the boundary element influence matrix and overwrites it to <code>influence</code> (which would need to be subtracted for it to act like the RHS of a linear system). Based on the current state of the <code>target_buffer</code> and <code>source_buffer</code>. Should be overloaded for each system type that is used in the boundary element solver.</p><p><strong>Arguments:</strong></p><ul><li><code>influence::AbstractVector{TF}</code>: vector containing the influence for every body in the target buffer</li><li><code>target_buffer::Matrix{TF}</code>: target buffer used to compute the influence</li><li><code>source_system::{UserDefinedSystem}</code>: system object used solely for dispatch</li><li><code>source_buffer::Matrix{TF}</code>: source buffer used to compute the influence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L263-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.influence!-Union{Tuple{TF}, Tuple{Vector{TF}, Array{Vector{TF}, 1}, Tuple, Tuple, Tuple, Tree}} where TF" href="#FastMultipole.influence!-Union{Tuple{TF}, Tuple{Vector{TF}, Array{Vector{TF}, 1}, Tuple, Tuple, Tuple, Tree}} where TF"><code>FastMultipole.influence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">influence!(sorted_influences, influences_per_system, target_buffers, source_systems, source_buffers, source_tree)</code></pre><p>Evaluate the influence as pertains to the boundary element influence matrix and subtracts it from <code>sorted_influences</code> (which would act like the RHS of a linear system). Based on the current state of the <code>target_buffers</code> and <code>source_buffers</code>. Note that <code>source_systems</code> is provided solely for dispatch. Note also that <code>influences_per_system</code> is overwritten each time.</p><ul><li><code>sorted_influences::Vector{Float64}</code>: single vector containing the influence for every body in the target buffers, sorted by source branch in the direct interaction list</li><li><code>influences_per_system::Vector{Vector{Float64}}</code>: vector of vectors containing the influence for each target system, sorted the same way as the buffers</li><li><code>target_buffers::NTuple{N,Matrix{Float64}}</code>: target buffers used to compute the influence</li><li><code>source_systems::NTuple{N,&lt;:{UserDefinedSystem}}</code>: system objects used for dispatch</li><li><code>source_buffers::NTuple{N,Matrix{Float64}}</code>: source buffers used to compute the influence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L948-L959">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.local_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}" href="#FastMultipole.local_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.local_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Multipole coefficients up to expansion order `P+1` must be added to `multipole_branch` before calling this function.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/error.jl#L288-L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.local_power-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.local_power-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_power</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>performs the lamb-helmholtz transformation assuming that the coordinate system is still aligned with the z axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L452-L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ηs<em>mag and Hs</em>π2 to be precomputed. Ts and eimϕs are computed here.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L1893-L1895">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.make_direct_assignments!-NTuple{9, Any}" href="#FastMultipole.make_direct_assignments!-NTuple{9, Any}"><code>FastMultipole.make_direct_assignments!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_direct_assignments!(assignments, i_target_system, target_branches, i_source_system, source_branches, direct_list, n_threads, n_per_thread, interaction_list_method)</code></pre><p>Assumes <code>direct_list</code> is sorted by target branch index. Assigns ranges of interactions to each thread.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/fmm.jl#L51-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.map_by_branch-Tuple{Tree}" href="#FastMultipole.map_by_branch-Tuple{Tree}"><code>FastMultipole.map_by_branch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">map_by_branch(target_tree::Tree)</code></pre><p>Constructs a mapping from each branch to the range of indices in the targets vector that correspond to the bodies in that branch.</p><p>This relies on the fact that <code>tree.leaf_index</code> is sorted in order of increasing branch index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L489-L496">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.map_by_leaf-Tuple{Tree}" href="#FastMultipole.map_by_leaf-Tuple{Tree}"><code>FastMultipole.map_by_leaf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">map_by_leaf(source_tree::Tree)</code></pre><p>Constructs a mapping from each leaf to the range of indices in the strengths vector that correspond to the bodies in that leaf.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L465-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}" href="#FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}"><code>FastMultipole.mirrored_source_to_vortex!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>my derivation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/bodytomultipole.jl#L280-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}" href="#FastMultipole.multipole_error-Tuple{Any, Any, Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.multipole_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Multipole coefficients up to expansion order `P+1` must be added to `multipole_branch` before calling this function.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/error.jl#L125-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-NTuple{16, Any}" href="#FastMultipole.multipole_to_local!-NTuple{16, Any}"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>defaults to no error prediction</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L1414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsoluteGradient{ε, BE}}} where {LH, ε, BE}" href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsoluteGradient{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L1121-L1123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential{ε, BE}}} where {LH, ε, BE}" href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L828-L830">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, RotatedCoefficientsAbsoluteGradient{ε, BE}}} where {LH, ε, BE}" href="#FastMultipole.multipole_to_local!-Union{Tuple{BE}, Tuple{ε}, Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, RotatedCoefficientsAbsoluteGradient{ε, BE}}} where {LH, ε, BE}"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L552-L554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH" href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L516-L518">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.nearfield_device!-Tuple{Any, Any, Any}" href="#FastMultipole.nearfield_device!-Tuple{Any, Any, Any}"><code>FastMultipole.nearfield_device!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearfield_device!(target_systems, derivatives_switches, source_systems)</code></pre><p>Dispatches <code>nearfield_device!</code> without having to build a <code>::Tree</code>. Performs all interactions.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems</code>: user-defined system on which <code>source_system</code> acts</li><li><code>derivatives_switches::Union{DerivativesSwitch, NTuple{N,DerivativesSwitch}}</code>: determines whether the scalar potential, vector field, and or vector gradient should be calculated</li><li><code>source_systems</code>: user-defined system acting on <code>target_system</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/fmm.jl#L202-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}" href="#FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}"><code>FastMultipole.nearfield_device!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearfield_device!(target_systems, target_tree, derivatives_switches, source_systems, source_tree, direct_list)</code></pre><p>User-defined function used to offload nearfield calculations to a device, such as GPU.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems</code>: user-defined system on which <code>source_system</code> acts</li><li><code>target_tree::Tree</code>: octree object used to sort <code>target_systems</code></li><li><code>derivatives_switches::Union{DerivativesSwitch, NTuple{N,DerivativesSwitch}}</code>: determines whether the scalar potential, vector field, and or vector gradient should be calculated</li><li><code>source_systems</code>: user-defined system acting on <code>target_system</code></li><li><code>source_tree::Tree</code>: octree object used to sort <code>target_systems</code></li><li><code>direct_list::Vector{SVector{2,Int32}}</code>: each element <code>[i,j]</code> maps nearfield interaction from <code>source_tree.branches[j]</code> on <code>target_tree.branches[i]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/fmm.jl#L183-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.predict_error-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential}} where LH" href="#FastMultipole.predict_error-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, PowerAbsolutePotential}} where LH"><code>FastMultipole.predict_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>performs a partial M2L for expansion_order+1, and predicts the error along the way;</p><p>expects that the upward pass has been performed up to expansion_order+1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/error.jl#L466-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_multipole_y!-NTuple{8, Any}" href="#FastMultipole.rotate_multipole_y!-NTuple{8, Any}"><code>FastMultipole.rotate_multipole_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Rotate solid harmonic weights about the y axis by θ. Note that Hs<em>π2 and ζs</em>mag must be updated a priori, but Ts is updated en situ. Resets rotated_weights before computing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L912-L914">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.rotate_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs a z-axis rotation of the supplied solid harmonic coefficients. Computes e^{imϕ} as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L445-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH" href="#FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs a z-axis rotation of the supplied solid harmonic coefficients. Computes e^{imϕ} as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L500-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_z_n_power!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH" href="#FastMultipole.rotate_z_n_power!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n_power!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs a z-axis rotation of the supplied solid harmonic coefficients. Computes e^{imϕ} and the multipole power at n as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L530-L532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.self_influence_matrices-Union{Tuple{TF}, Tuple{Any, Any, Any, Tree{TF}, Any, Any}} where TF" href="#FastMultipole.self_influence_matrices-Union{Tuple{TF}, Tuple{Any, Any, Any, Tree{TF}, Any, Any}} where TF"><code>FastMultipole.self_influence_matrices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">self_influence_matrices(target_buffers, source_buffers, source_systems, target_tree, source_tree, derivatives_switches)</code></pre><p>Constructs influence matrices for all leaves of the tree. (Assumes source tree and target trees are identical.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L373-L377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.set_gradient!-Tuple{Matrix, Any, Any}" href="#FastMultipole.set_gradient!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_gradient!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_gradient!(target_buffer, i_body, gradient)</code></pre><p>Accumulates <code>gradient</code> to <code>target_buffer</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L463-L468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.set_hessian!-Tuple{Matrix, Any, Any}" href="#FastMultipole.set_hessian!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_hessian!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_hessian!(target_buffer, i_body, hessian)</code></pre><p>Accumulates <code>hessian</code> to <code>target_buffer</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L475-L480">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.set_scalar_potential!-Tuple{Matrix, Any, Any}" href="#FastMultipole.set_scalar_potential!-Tuple{Matrix, Any, Any}"><code>FastMultipole.set_scalar_potential!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_scalar_potential!(target_buffer, i_body, scalar_potential)</code></pre><p>Accumulates <code>scalar_potential</code> to <code>target_buffer</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L453-L458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.shrink_branch!-Tuple{Any, Any, Any}" href="#FastMultipole.shrink_branch!-Tuple{Any, Any, Any}"><code>FastMultipole.shrink_branch!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the smallest bounding box to completely bound all child boxes.</p><p>Shrunk radii are merely the distance from the center to the corner of the box.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/tree.jl#L1158-L1162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.source_system_to_buffer!-NTuple{4, Any}" href="#FastMultipole.source_system_to_buffer!-NTuple{4, Any}"><code>FastMultipole.source_system_to_buffer!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_system_to_buffer!(buffer::Matrix, i_buffer, system::{UserDefinedSystem}, i_body)</code></pre><p>Compatibility function used to sort source systems. It should be overloaded for each system (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system) to be used as a source and should behave as follows. For the <code>i_body</code>th body contained inside of <code>system</code>,</p><ul><li><code>buffer[1:3, i_buffer]</code> should be set to the x, y, and z coordinates of the body position used for sorting into the octree</li><li><code>buffer[4, i_buffer]</code> should be set to the radius beyond which a multipole expansion is allowed to be evaluated (e.g. for panels, or other bodies of finite area/volume)</li><li><code>buffer[5:4+strength_dims, i_buffer]</code> should be set to the body strength, which is a vector of length <code>strength_dims</code></li></ul><p>Any additional information required for either forming multipole expansions or computing direct interactions should be stored in the rest of the column.</p><p>If a body contains vertices that are required for, e.g. computing multipole coefficients of dipole panels, these must be stored immediately following the body strength, and should be listed in a counter-clockwise order. For example, if I am using vortex tri-panels with <code>strength_dims=3</code>, I would set <code>buffer[8:10,i] .= v1</code>, <code>buffer[11:13,i] .= v2</code>, and <code>bufer[14:16,i] .= v3</code>, where <code>v1</code>, <code>v2</code>, and <code>v3</code> are listed according to the right-hand-rule with thumb aligned with the panel normal vector.</p><p>Note that any system acting only as a target need not overload <code>source_system_to_buffer!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L5-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.source_to_dipole!-NTuple{7, Any}" href="#FastMultipole.source_to_dipole!-NTuple{7, Any}"><code>FastMultipole.source_to_dipole!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes source expansion coefficients have already been calculated</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/bodytomultipole.jl#L248-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.source_to_vortex_point!-NTuple{7, Any}" href="#FastMultipole.source_to_vortex_point!-NTuple{7, Any}"><code>FastMultipole.source_to_vortex_point!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>might be slightly faster than mirrored<em>source</em>to_vortex</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/bodytomultipole.jl#L336-L338">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.strength_dims-Tuple{Any}" href="#FastMultipole.strength_dims-Tuple{Any}"><code>FastMultipole.strength_dims</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">strength_dims(system::{UserDefinedSystem})</code></pre><p>Returns the cardinality of the vector used to define the strength of each body inside <code>system</code>. E.g., a point mass would return 1, and a point dipole would return 3. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.strength_to_value-Tuple{Any, Any}" href="#FastMultipole.strength_to_value-Tuple{Any, Any}"><code>FastMultipole.strength_to_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">strength_to_value(strength, source_system)</code></pre><p><strong>NOTE:</strong> this function is primarily used for the boundary element solver, and is not required for the FMM.</p><p>Converts the strength of a body in <code>source_system</code> to a scalar value. Should be overloaded for each user-defined system object used with the boundary element solver.</p><p><strong>Arguments:</strong></p><ul><li><code>strength::SVector{dim, Float64}</code>: the strength of the body, where <code>dim</code> is the number of components in the strength vector (e.g., 1 for a point source, 3 for a point vortex, etc.)</li><li><code>source_system::{UserDefinedSystem}</code>: the user-defined system object, used solely for dispatch</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L200-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.target_influence_to_buffer!-NTuple{5, Any}" href="#FastMultipole.target_influence_to_buffer!-NTuple{5, Any}"><code>FastMultipole.target_influence_to_buffer!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">target_influence_to_buffer!(target_buffer, i_buffer, ::DerivativesSwitch{PS,GS,HS}, target_system::{UserDefinedSystem}, i_target) where {PS,GS,HS}</code></pre><p><strong>NOTE:</strong> this function is primarily used for the boundary element solver, and is not required for the FMM.</p><p>Updates the <code>target_buffer</code> with influences from <code>target_system</code> for the <code>i_target</code>th body. Should be overloaded for each user-defined system object (where <code>{UserDefinedSystem}</code> is replaced with the type of the user-defined system) to be used as a target, assuming the target buffer positions have already been set. It should behave as follows:</p><ul><li><code>target_buffer[4, i_buffer]</code> should be set to the scalar potential at the body position</li><li><code>target_buffer[5:7, i_buffer]</code> should be set to the vector field at the body position</li><li><code>target_buffer[8:16, i_buffer]</code> should be set to the vector gradient at the body position</li></ul><p>The following convenience functions can may be used to access the buffer:</p><ul><li><code>set_scalar_potential!(target_buffer, i_buffer, scalar_potential)</code>: accumulates the <code>scalar_potential</code> to the <code>i_buffer</code> body in <code>target_buffer</code></li><li><code>set_gradient!(target_buffer, i_buffer, gradient)</code>: accumulates <code>gradient</code> to the <code>i_buffer</code> body in <code>target_buffer</code></li><li><code>set_hessian!(target_buffer, i_buffer, hessian)</code>: accumulates <code>hessian</code> to the <code>i_buffer</code> body in <code>target_buffer</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L178-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_local_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L1848-L1850">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L178-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH" href="#FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH"><code>FastMultipole.translate_multipole_to_local_z_m01_n</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function should receive n!<em>t</em>np1 = 1/t when n=0</p><p>Calculates ϕn0, ϕn1, χn1 for P=n</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L297-L301">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_to_local_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_multipole_to_local_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L235-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/translate.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.tune_fmm-Tuple{Tuple, Tuple}" href="#FastMultipole.tune_fmm-Tuple{Tuple, Tuple}"><code>FastMultipole.tune_fmm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tune_fmm(target_systems, source_systems; optargs...)</code></pre><p>Tune the Fast Multipole Method (FMM) parameters for optimal performance on the given target and source systems, optionally subject to an error tolerance.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems::Union{Tuple,{UserDefinedSystem}}</code>: a user-defined system object (or a tuple of them) for which the FMM interface functions have been defined</li><li><code>source_systems::Union{Tuple,{UserDefinedSystem}}</code>: a user-defined system object (or a tuple of them) for which the FMM interface functions have been defined</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>ε_tol::Union{Nothing,Float64}</code>: the error tolerance for the FMM; if <code>nothing</code>, the FMM will simply use the <code>expansion_order</code> keyword argument to fix the expansion order</li><li><code>expansion_order::Int</code>: the max expansion order for the FMM; defaults to 4</li><li><code>leaf_size_source::Int</code>: the leaf size for the source systems; defaults to <code>default_leaf_size(source_systems)</code></li><li><code>max_expansion_order::Int</code>: the maximum allowable expansion order if an error tolerance is requested; defaults to 20</li><li><code>multipole_acceptances::AbstractRange{Float64}</code>: a range of multipole acceptance critia to test; defaults to <code>range(0.3, stop=0.8, step=0.1)</code></li><li><code>lamb_helmholtz::Bool</code>: whether to use the Lamb-Hellmholtz decomposition; defaults to <code>false</code></li><li><code>verbose::Bool</code>: whether to print progress information; defaults to <code>true</code></li><li><code>kwargs...</code>: additional keyword arguments to pass to the <code>fmm!</code> function</li></ul><p><strong>Returns</strong></p><ul><li><p><code>tuned_params::NamedTuple</code>: a named tuple containing the best parameters found during tuning, which can be used in subsequent <code>fmm!</code> calls by splatting it as a keyword argument:`:</p><ul><li><code>leaf_size_source::Int</code>: the optimal leaf size for the source systems</li><li><code>expansion_order::Int</code>: the optimal expansion order for the FMM</li><li><code>multipole_acceptance::Float64</code>: the optimal multipole acceptance criterion</li></ul></li><li><p><code>cache::Tuple</code>: a tuple containing the cache used during tuning, which can be reused for subsequent <code>fmm!</code> calls by splatting it as a keyword argument</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/autotune.jl#L21-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF" href="#FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF"><code>FastMultipole.update_Ts_0!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns sβ, cβ, and <em>1</em>n appropriate for calling update<em>Ts</em>n! for n=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L348-L350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_eimϕs_0!-Tuple{Any, Any}" href="#FastMultipole.update_eimϕs_0!-Tuple{Any, Any}"><code>FastMultipole.update_eimϕs_0!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns eiϕ<em>real, eiϕ</em>imag, eimϕ<em>real, and eimϕ</em>imag appropriate for inputs for n=1 in update<em>eimϕs</em>n!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L38-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_eimϕs_n!-NTuple{6, Any}" href="#FastMultipole.update_eimϕs_n!-NTuple{6, Any}"><code>FastMultipole.update_eimϕs_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns eimϕ<em>real and eimϕ</em>imag for n</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/rotate.jl#L49-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_nonself_influence!-Tuple{Any, Vector, FastMultipole.Matrices, Vector, Tree, Tree, Vector{UnitRange{Int64}}, Vector{UnitRange{Int64}}, Vector{StaticArraysCore.SVector{2, Int32}}, Vector{UnitRange{Int64}}}" href="#FastMultipole.update_nonself_influence!-Tuple{Any, Vector, FastMultipole.Matrices, Vector, Tree, Tree, Vector{UnitRange{Int64}}, Vector{UnitRange{Int64}}, Vector{StaticArraysCore.SVector{2, Int32}}, Vector{UnitRange{Int64}}}"><code>FastMultipole.update_nonself_influence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_nonself_influence!(right_hand_side, nonself_matrices::Matrices, old_influence_storage::Vector, source_tree::Tree, target_tree::Tree, strengths_by_leaf::Vector{UnitRange{Int}}, index_map::Vector{UnitRange{Int}}, direct_list::Vector{SVector{2,Int32}}, targets_by_branch::Vector{UnitRange{Int}})</code></pre><p>Updates the right-hand side vector based on the non-self influence matrices and the current strengths of the source systems. Does this by removing the old influence and adding the new.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/solve.jl#L722-L727">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.value_to_strength!-NTuple{4, Any}" href="#FastMultipole.value_to_strength!-NTuple{4, Any}"><code>FastMultipole.value_to_strength!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_to_strength!(source_buffer, source_system, i_body, value)</code></pre><p><strong>NOTE:</strong> this function is primarily used for the boundary element solver, and is not required for the FMM.</p><p>Converts a scalar value to a vector strength of a body in <code>source_system</code>. Should be overloaded for each user-defined system object used with the boundary element solver.</p><p><strong>Arguments:</strong></p><ul><li><code>source_buffer::Matrix{Float64}</code>: the source buffer containing the body information</li><li><code>source_system::{UserDefinedSystem}</code>: the user-defined system object, used solely for dispatch</li><li><code>i_body::Int</code>: the index of the body in <code>source_buffer</code> to set the strength for</li><li><code>value::Float64</code>: the scalar value used to set the strength</li></ul><p>The following convenience function may be helpful when accessing the buffer:</p><ul><li><code>get_strength(source_buffer, source_system, i_body)</code>: returns the strength of the <code>i_body</code> body in <code>source_buffer</code>, formatted as a vector (e.g. <code>strength::SVector{dim,Float64}</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/939bc7255cb538762dc4544a4dcdcbaf1c4cfdaf/src/compatibility.jl#L221-L239">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advanced_usage_2/">« Automated Tuning</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 19:39">Wednesday 18 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
