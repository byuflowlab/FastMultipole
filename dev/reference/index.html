<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · FastMultipole.jl</title><meta name="title" content="Reference · FastMultipole.jl"/><meta property="og:title" content="Reference · FastMultipole.jl"/><meta property="twitter:title" content="Reference · FastMultipole.jl"/><meta name="description" content="Documentation for FastMultipole.jl."/><meta property="og:description" content="Documentation for FastMultipole.jl."/><meta property="twitter:description" content="Documentation for FastMultipole.jl."/><meta property="og:url" content="https://flow.byu.edu/FastMultipole/reference/"/><meta property="twitter:url" content="https://flow.byu.edu/FastMultipole/reference/"/><link rel="canonical" href="https://flow.byu.edu/FastMultipole/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FastMultipole.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../guided_examples/">Guided Examples</a></li><li><a class="tocitem" href="../advanced_usage/">Advanced Usage</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li><li><a class="tocitem" href="../theory/">Theory</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.ExpansionSwitch"><code>FastMultipole.ExpansionSwitch</code></a></li><li><a href="#FastMultipole.MultiBranch"><code>FastMultipole.MultiBranch</code></a></li><li><a href="#FastMultipole.MultiTree"><code>FastMultipole.MultiTree</code></a></li><li><a href="#FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.SingleBranch"><code>FastMultipole.SingleBranch</code></a></li><li><a href="#FastMultipole.SortWrapper-Tuple{Any}"><code>FastMultipole.SortWrapper</code></a></li><li><a href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a></li><li><a href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a></li><li><a href="#FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH"><code>FastMultipole._rotate_multipole_y_n!</code></a></li><li><a href="#FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}"><code>FastMultipole.add_line!</code></a></li><li><a href="#FastMultipole.back_rotate_local_y!-NTuple{7, Any}"><code>FastMultipole.back_rotate_local_y!</code></a></li><li><a href="#FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}"><code>FastMultipole.back_rotate_multipole_y!</code></a></li><li><a href="#FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.back_rotate_z!</code></a></li><li><a href="#FastMultipole.calculate_ib!-NTuple{7, Any}"><code>FastMultipole.calculate_ib!</code></a></li><li><a href="#FastMultipole.calculate_pj!-NTuple{7, Any}"><code>FastMultipole.calculate_pj!</code></a></li><li><a href="#FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}"><code>FastMultipole.closest_corner</code></a></li><li><a href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a></li><li><a href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.direct!-Tuple{Any, Any}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Any, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.local_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.local_error</code></a></li><li><a href="#FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_to_local!</code></a></li><li><a href="#FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}"><code>FastMultipole.mirrored_source_to_vortex!</code></a></li><li><a href="#FastMultipole.multipole_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.multipole_error</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.multipole_to_local!-NTuple{11, Any}"><code>FastMultipole.multipole_to_local!</code></a></li><li><a href="#FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}"><code>FastMultipole.nearfield_device!</code></a></li><li><a href="#FastMultipole.nearfield_device!-Tuple{Any, Any, Any}"><code>FastMultipole.nearfield_device!</code></a></li><li><a href="#FastMultipole.reset!-Tuple{ProbeSystem}"><code>FastMultipole.reset!</code></a></li><li><a href="#FastMultipole.resort!-Tuple{Tuple, MultiTree}"><code>FastMultipole.resort!</code></a></li><li><a href="#FastMultipole.rotate_multipole_y!-NTuple{8, Any}"><code>FastMultipole.rotate_multipole_y!</code></a></li><li><a href="#FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.rotate_z!</code></a></li><li><a href="#FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n!</code></a></li><li><a href="#FastMultipole.shrink_branch!-Tuple{Any, Any, Any}"><code>FastMultipole.shrink_branch!</code></a></li><li><a href="#FastMultipole.source_to_dipole!-NTuple{7, Any}"><code>FastMultipole.source_to_dipole!</code></a></li><li><a href="#FastMultipole.source_to_vortex_point!-NTuple{7, Any}"><code>FastMultipole.source_to_vortex_point!</code></a></li><li><a href="#FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_local_z!</code></a></li><li><a href="#FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z!</code></a></li><li><a href="#FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH"><code>FastMultipole.translate_multipole_to_local_z_m01_n</code></a></li><li><a href="#FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_z!</code></a></li><li><a href="#FastMultipole.unsort!-Tuple{Tuple, MultiTree}"><code>FastMultipole.unsort!</code></a></li><li><a href="#FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF"><code>FastMultipole.update_Ts_0!</code></a></li><li><a href="#FastMultipole.update_eimϕs_0!-Tuple{Any, Any}"><code>FastMultipole.update_eimϕs_0!</code></a></li><li><a href="#FastMultipole.update_eimϕs_n!-NTuple{6, Any}"><code>FastMultipole.update_eimϕs_n!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch" href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch</code></pre><p>Switch indicating whether the scalar potential, vector potential, velocity, and/or velocity gradient should be computed for a target system. Information is stored as type parameters, allowing the compiler to compile away if statements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}" href="#FastMultipole.DerivativesSwitch-Tuple{Any, Any, Any}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, velocity, velocity_gradient)</code></pre><p>Constructs a tuple of <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>velocity::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the velocity should be computed for each target system</li><li><code>velocity_gradient::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the velocity gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/derivativesswitch.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}" href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, velocity, velocity_gradient, target_systems)</code></pre><p>Constructs a <code>::Tuple</code> of indentical <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects of the same length as <code>target_systems</code> (if it is a <code>::Tuple</code>), or a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> (if <code>target_system</code> is not a <code>::Tuple</code>)</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>velocity::Bool</code>: a <code>::Bool</code> indicating whether the velocity should be computed for each target system</li><li><code>velocity_gradient::Bool</code>: a <code>::Bool</code> indicating whether the velocity gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/derivativesswitch.jl#L33-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}" href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, velocity, velocity_gradient)</code></pre><p>Constructs a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> object.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for the target system</li><li><code>velocity::Bool</code>: a <code>::Bool</code> indicating whether the velocity should be computed for the target system</li><li><code>velocity_gradient::Bool</code>: a <code>::Bool</code> indicating whether the velocity gradient should be computed for the target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/derivativesswitch.jl#L17-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ExpansionSwitch" href="#FastMultipole.ExpansionSwitch"><code>FastMultipole.ExpansionSwitch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExpansionSwitch</code></pre><p>Switch indicating which expansions should be used:</p><ol><li>scalar potential (<code>SP</code>)</li><li>vector potential via Lamb-Helmholtz decomposition (<code>VP</code>)</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L61-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.MultiBranch" href="#FastMultipole.MultiBranch"><code>FastMultipole.MultiBranch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MultiBranch{TF,N} &lt;: Branch{TF}</code></pre><p>Branch object used to sort more than one system into an octree. Type parameters represent:</p><ul><li><code>TF</code>: the floating point type (would be a dual number if using algorithmic differentiation)</li><li><code>N</code>: the number of systems represented</li></ul><p><strong>Fields</strong></p><ul><li><code>bodies_index::Vector{UnitRange}</code>: vector of unit ranges indicating the index of bodies in each represented system, respectively</li><li><code>n_branches::Int</code>: number of child branches corresponding to this branch</li><li><code>branch_index::UnitRange</code>: indices of this branch&#39;s child branches</li><li><code>i_parent::Int</code>: index of this branch&#39;s parent</li><li><code>i_leaf::Int</code>: if this branch is a leaf, what is its index in its parent <code>&lt;:Tree</code>&#39;s <code>leaf_index</code> field</li><li><code>center::Vector{TF}</code>: center of this branch at which its multipole and local expansions are centered</li><li><code>source_radius::TF</code>: if this branch is a leaf, distance from <code>center</code> to the outer edge of farthest body contained in this branch; otherwise, this is the distance from <code>center</code> to the corner of its <code>source_box</code></li><li><code>target_radius::TF</code>: distance from <code>center</code> to the farthest body center contained in this branch</li><li><code>source_box::Vector{TF}</code>: vector of length 6 containing the distances from the center to faces of a rectangular prism completely enclosing all bodies with their finite radius in the negative x, positive x, negative y, positive y, negative z, and positive z directions, respectively</li><li><code>target_box::Vector{TF}</code>: vector of length 3 containing the distances from the center to faces of a rectangular prism completely enclosing all body centers in the x, y, and z direction, respectively</li><li>multipole_expansion::Array{TF,3}<code>: array of size (2,2,) containing the multipole expansion coefficients; the first index indicates real or imaginary, the second index indicates scalar potential or the second component of the Lamb-Helmholtz decomposition, and the third index</code>k` indicates the expansion coefficient of degree <span>$n$</span> and order <span>$m$</span>, as <span>$k = p(p+1)/2 + m + 1$</span></li><li>local_expansion::Array{TF,3}<code>: array of size</code>(2,2,(p+1)(p+2)/2)<code>containing the local expansion coefficients; the first index indicates real or imaginary, the second index indicates scalar potential or the second component of the Lamb-Helmholtz decomposition, and the third index</code>k` indicates the expansion coefficient of degree <span>$n$</span> and order <span>$m$</span>, as <span>$k = p(p+1)/2 + m + 1$</span></li><li><code>harmonics::Array{TF,3}</code>: array of size <code>(2,2,(p+1)(p+2)/2)</code> used as storage for regular harmonics, irregular harmonics, or whatever is needed, and is indexed as multipole and local expansions</li><li><code>lock::ReentrantLock</code>: lock used to avoid data race conditions when modifying this branch or its corresponding bodies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L148-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.MultiTree" href="#FastMultipole.MultiTree"><code>FastMultipole.MultiTree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bodies[index<em>list] is the same sort operation as performed by the tree sorted</em>bodies[inverse<em>index</em>list] undoes the sort operation performed by the tree</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L260-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem" href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem</code></pre><p>Convenience system for defining locations at which the potential, velocity, or velocity gradient may be desired.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L311-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF" href="#FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem(positions; kwargs...)</code></pre><p>A convenience system constructor for calculating the influence of source systems at locations not already described by a system object. It behaves like a system whose elements induce a null potential field.</p><p><strong>Arguments</strong></p><ul><li><code>positions::Vector{SVector{3,Float64}}</code>: a vector of position vectors of each probe</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: whether or not to compute the scalar potential at each probe location</li><li><code>vector_potential::Bool</code>: whether or not to compute the vector potential at each probe location</li><li><code>velocity::Bool</code>: whether or not to compute the velocity at each probe location</li><li><code>velocity_gradient::Bool</code>: whether or not to compute the velocity gradient at each probe location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/probe.jl#L9-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF" href="#FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem(positions; kwargs...)</code></pre><p>Dispatch of <a href="#FastMultipole.ProbeSystem"><code>ProbeSystem</code></a> accepting a matrix of horizontally concatenated column vectors describing the position of each probe. Optional arguments are identical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/probe.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.SingleBranch" href="#FastMultipole.SingleBranch"><code>FastMultipole.SingleBranch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SingleBranch{TF} &lt;: Branch{TF}</code></pre><p>Branch object used to sort a single system into an octree. Type parameters represent:</p><ul><li><code>TF</code>: the floating point type (would be a dual number if using algorithmic differentiation)</li></ul><p><strong>Fields</strong></p><ul><li><code>bodies_index::UnitRange</code>: unit range indicating the index of bodies in the represented system</li><li><code>n_branches::Int</code>: number of child branches corresponding to this branch</li><li><code>branch_index::UnitRange</code>: indices of this branch&#39;s child branches</li><li><code>i_parent::Int</code>: index of this branch&#39;s parent</li><li><code>i_leaf::Int</code>: if this branch is a leaf, what is its index in its parent <code>&lt;:Tree</code>&#39;s <code>leaf_index</code> field</li><li><code>center::Vector{TF}</code>: center of this branch at which its multipole and local expansions are centered</li><li><code>source_radius::TF</code>: if this branch is a leaf, distance from <code>center</code> to the outer edge of farthest body contained in this branch; otherwise, this is the distance from <code>center</code> to the corner of its <code>source_box</code></li><li><code>target_radius::TF</code>: distance from <code>center</code> to the farthest body center contained in this branch</li><li><code>source_box::Vector{TF}</code>: vector of length 6 containing the distances from the center to faces of a rectangular prism completely enclosing all bodies with their finite radius in the negative x, positive x, negative y, positive y, negative z, and positive z directions, respectively</li><li><code>target_box::Vector{TF}</code>: vector of length 3 containing the distances from the center to faces of a rectangular prism completely enclosing all body centers in the x, y, and z direction, respectively</li><li>multipole_expansion::Array{TF,3}<code>: array of size (2,2,) containing the multipole expansion coefficients; the first index indicates real or imaginary, the second index indicates scalar potential or the second component of the Lamb-Helmholtz decomposition, and the third index</code>k` indicates the expansion coefficient of degree <span>$n$</span> and order <span>$m$</span>, as <span>$k = p(p+1)/2 + m + 1$</span></li><li>local_expansion::Array{TF,3}<code>: array of size</code>(2,2,(p+1)(p+2)/2)<code>containing the local expansion coefficients; the first index indicates real or imaginary, the second index indicates scalar potential or the second component of the Lamb-Helmholtz decomposition, and the third index</code>k` indicates the expansion coefficient of degree <span>$n$</span> and order <span>$m$</span>, as <span>$k = p(p+1)/2 + m + 1$</span></li><li><code>harmonics::Array{TF,3}</code>: array of size <code>(2,2,(p+1)(p+2)/2)</code> used as storage for regular harmonics, irregular harmonics, or whatever is needed, and is indexed as multipole and local expansions</li><li><code>lock::ReentrantLock</code>: lock used to avoid data race conditions when modifying this branch or its corresponding bodies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L201-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.SortWrapper-Tuple{Any}" href="#FastMultipole.SortWrapper-Tuple{Any}"><code>FastMultipole.SortWrapper</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SortWrapper(system)</code></pre><p>Convenience wrapper for systems whose elements cannot be sorted in-place (e.g. structured grids). The resulting object is treated like any other <code>system</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/sortwrapper.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.Tree" href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type Tree{TF,P} end</code></pre><p>Supertype of all octree structures with <code>TF</code> the floating point type and <code>P</code> the expansion order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/containers.jl#L253-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.EmptyTree-Tuple{Any}" href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmptyTree(system)</code></pre><p>Returns an empty tree. Used if <code>system</code> is empty.</p><p><strong>Arguments</strong></p><ul><li><code>system</code>: the system from which a tree is to be created</li></ul><p><strong>Returns</strong></p><ul><li><code>tree</code>: if <code>typeof(system)&lt;:Tuple</code>, a <code>::MultiTree</code> is returned; otherwise, a <code>::SingleTree</code> is returned</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/tree.jl#L97-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH" href="#FastMultipole._rotate_multipole_y_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}, Any, Any, Any}} where LH"><code>FastMultipole._rotate_multipole_y_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The first time this function is called, it should receive i<em>ζ=0, i</em>T=0, and n=0. It will return i<em>ζ and i</em>T appropriate for n+1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L754-L756">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}" href="#FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}"><code>FastMultipole.add_line!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_line!(probes::ProbeSystem, x1, x2, n_probes, i_last)</code></pre><p>Adds <code>n_probes</code> probes in a line between <code>x1</code> and <code>x2</code>. Specifically, they are added at the midpoint of equally partiti    oned segments of the line.</p><p><strong>Arguments</strong></p><ul><li><code>probes::ProbeSystem</code>: the probe system whose <code>.position</code> field is to be updated</li><li><code>x1::Vector{Float64}</code>: the first point defining the line along which probes are to be added</li><li><code>x2::Vector{Float64}</code>: the second point defining the line along which probes are to be added</li><li><code>n_probes::Int</code>: number of probes to be added</li><li><code>i_last::Int</code>: index of the last probe in <code>probes</code></li></ul><p><strong>Output</strong></p><ul><li><code>i_last::Int</code>: updated index of the last probe in <code>probes</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/probe.jl#L113-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_local_y!-NTuple{7, Any}" href="#FastMultipole.back_rotate_local_y!-NTuple{7, Any}"><code>FastMultipole.back_rotate_local_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes Ts, Hs<em>π2, and ηs</em>mag have all been precomputed. Resets target_weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L1072-L1074">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}" href="#FastMultipole.back_rotate_multipole_y!-NTuple{6, Any}"><code>FastMultipole.back_rotate_multipole_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes Ts, Hs<em>π2, and ζs</em>mag have all been precomputed. Resets target_weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L873-L875">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.back_rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.back_rotate_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assumes eimϕs have already been computed. DOES NOT overwrite rotated weights (unlike other rotate functions); rather, accumulates on top of it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L530-L532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.calculate_ib!-NTuple{7, Any}" href="#FastMultipole.calculate_ib!-NTuple{7, Any}"><code>FastMultipole.calculate_ib!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes j has already been calculated</p><p>Note: if X0<em>real is replaced with X0</em>real + Xw_real, etc., this becomes bnm (as used for volumes) instead of inm (as used for panels)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/bodytomultipole.jl#L169-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.calculate_pj!-NTuple{7, Any}" href="#FastMultipole.calculate_pj!-NTuple{7, Any}"><code>FastMultipole.calculate_pj!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes q has already been calculated</p><p>If X0<em>real is replaced with X0</em>real + Xv_real, etc., the result becomes jnm instead of pnm, as used for panels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/bodytomultipole.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}" href="#FastMultipole.closest_corner-Tuple{Any, Any, StaticArraysCore.SVector{3}}"><code>FastMultipole.closest_corner</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Vector from center 2 to the corner of box2 closest to center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/error.jl#L22-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.d2rdx2-Tuple{Any, Any, Any}" href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>k/dx</em>idx_j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/derivatives.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-Tuple{Any, Any}" href="#FastMultipole.direct!-Tuple{Any, Any}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(target_system, source_system; derivatives_switches)</code></pre><p>Applies all interactions of <code>source_system</code> acting on <code>target_system</code> without multipole acceleration.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_system</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_system</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/direct.jl#L33-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-Tuple{Tuple}" href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(systems; derivatives_switches)</code></pre><p>Applies all interactions of <code>systems</code> acting on itself without multipole acceleration.</p><p><strong>Arguments</strong></p><ul><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/direct.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.drdx-Tuple{Any, Any, Any}" href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>j/dx</em>i</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/derivatives.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Any, Any}" href="#FastMultipole.fmm!-Tuple{Any, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_systems, source_systems; kwargs...)</code></pre><p>Apply all interactions of <code>source_systems</code> acting on <code>target_systems</code> using the fast multipole method. Assumes compatibility functions have been overloaded for both source and target systems.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or - a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>expansion_order::Int</code>: the expansion order to be used</li><li><code>leaf_size_source::Int</code>: maximum number of bodies from <code>source_systems</code> allowed in a leaf-level branch</li><li><code>leaf_size_target::Int</code>: maximum number of bodies from <code>target_systems</code> allowed in a leaf-level branch</li><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>lamb_helmholtz::Bool</code>: determines whether or not to calculate the induced velocity due to a vector potential using the Lamb-Helmholtz decomposition; erroroneous velocity and gradient will result if <code>lamb_helmholtz==false</code> and a vector potential is used.</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for the <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for the <code>target_systems</code></li><li><code>source_shink_recenter::Bool</code>: indicates whether or not to resize branches for the <code>source_systems</code> octree after it is created to increase computational efficiency</li><li><code>target_shink_recenter::Bool</code>: indicates whether or not to resize branches for the <code>target_systems</code> octree after it is created to increase computational efficiency</li><li><code>save_tree_source::Bool</code>: indicates whether or not to save a VTK file for visualizing the source octree</li><li><code>save_tree_target::Bool</code>: indicates whether or not to save a VTK file for visualizing the target octree</li><li><code>save_name_source::String</code>: name and path of the source octree visualization if <code>save_tree == true</code></li><li><code>save_name_target::String</code>: name and path of the target octree visualization if <code>save_tree == true</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L776-L817">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Any}" href="#FastMultipole.fmm!-Tuple{Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(systems; kwargs...)</code></pre><p>Apply all interactions of <code>systems</code> acting on itself using the fast multipole method. Assumes compatibility functions have been overloaded for both source and target systems.</p><p><strong>Arguments</strong></p><ul><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>expansion_order::Int</code>: the expansion order to be used</li><li><code>leaf_size::Int</code>: maximum number of bodies from <code>systems</code> allowed in a leaf-level branch</li><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li><li><code>shink_recenter::Bool</code>: indicates whether or not to resize branches for the octree after it is created to increase computational efficiency</li><li><code>save_tree::Bool</code>: indicates whether or not to save a VTK file for visualizing the octree</li><li><code>save_name::String</code>: name and path of the octree visualization if <code>save_tree == true</code></li><li><code>nearfield_device::Bool</code>: indicates whether or not the <code>nearfield_device!</code> function should be used for nearfield interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L856-L888">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}" href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_tree, target_systems, source_tree, source_systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using existing <code>::Tree</code> objects.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>reset_source_tree::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(source_systems)</code> indicating whether or not to reset the expansions of each source tree</li><li><code>reset_target_tree::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(source_systems)</code> indicating whether or not to reset the expansions of each target tree</li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (computed without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (computed with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>target_systems</code></li><li><code>nearfield_device::Bool</code>: indicates whether or not the <code>nearfield_device!</code> function should be used for nearfield interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L978-L1015">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}" href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_tree, target_systems, source_tree, source_systems, m2l_list, direct_list, derivatives_switches; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using existing <code>::Tree</code> objects.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>m2l_list::Vector{SVector{2,Int32}}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which multipole expansions of the source branch are to be transformed to local expansions at the target branch</p></li><li><p><code>direct_list::Union{Vector{SVector{2,Int32}}, InteractionList}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which interactions are to be evaluted without multipole expansion (i.e., directly); if <code>typeof(direct_list) &lt;: InteractionList</code>, then prepared influence matrices are used rather than computing direct influences on the fly</p></li><li><p><code>derivatives_switches::Union{DerivativesSwitch, Tuple{&lt;:DerivativesSwitch,...}}</code>: switch determining which of scalar potential, vector potential, velocity, and/or velocity gradient are to be computed for each target system</p></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>target_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L1095-L1133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any}" href="#FastMultipole.fmm!-Tuple{Tree, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(tree, systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using an existing <code>::Tree</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (computed without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (computed with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li><li><code>nearfield_device::Bool</code>: indicates whether or not the <code>nearfield_device!</code> function should be used for nearfield interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L920-L948">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}" href="#FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(tree, systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using an existing <code>::Tree</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>m2l_list::Vector{SVector{2,Int32}}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which multipole expansions of the source branch are to be transformed to local expansions at the target branch</p></li><li><p><code>direct_list::Union{Vector{SVector{2,Int32}}, InteractionList}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which interactions are to be evaluted without multipole expansion (i.e., directly); if <code>typeof(direct_list) &lt;: InteractionList</code>, then prepared influence matrices are used rather than computing direct influences on the fly</p></li><li><p><code>derivatives_switches::Union{DerivativesSwitch, Tuple{&lt;:DerivativesSwitch,...}}</code>: switch determining which of scalar potential, vector potential, velocity, and/or velocity gradient are to be computed for each target system</p></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L1046-L1070">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.local_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}" href="#FastMultipole.local_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.local_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Multipole coefficients up to expansion order `P+1` must be added to `multipole_branch` before calling this function.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/error.jl#L284-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.local_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.local_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ηs<em>mag and Hs</em>π2 to be precomputed. Ts and eimϕs are computed here.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L549-L551">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}" href="#FastMultipole.mirrored_source_to_vortex!-NTuple{6, Any}"><code>FastMultipole.mirrored_source_to_vortex!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>my novel derivation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/bodytomultipole.jl#L271-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}" href="#FastMultipole.multipole_error-Tuple{Any, Any, Any, FastMultipole.RotatedCoefficients, Val}"><code>FastMultipole.multipole_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Multipole coefficients up to expansion order `P+1` must be added to `multipole_branch` before calling this function.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/error.jl#L124-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-NTuple{11, Any}" href="#FastMultipole.multipole_to_local!-NTuple{11, Any}"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>defaults to no error prediction</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L498">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH" href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L453-L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH" href="#FastMultipole.multipole_to_local!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Val{LH}, Nothing}} where LH"><code>FastMultipole.multipole_to_local!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Expects ζs<em>mag, ηs</em>mag, and Hs_π2 to be computed a priori.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L313-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.nearfield_device!-Tuple{Any, Any, Any}" href="#FastMultipole.nearfield_device!-Tuple{Any, Any, Any}"><code>FastMultipole.nearfield_device!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearfield_device!(target_systems, derivatives_switches, source_systems)</code></pre><p>Dispatches <code>nearfield_device!</code> without having to build a <code>::Tree</code>. Performs all interactions.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems</code>: user-defined system on which <code>source_system</code> acts</li><li><code>derivatives_switches::Union{DerivativesSwitch, NTuple{N,DerivativesSwitch}}</code>: determines whether the scalar potential, velocity, and or velocity gradient should be calculated</li><li><code>source_systems</code>: user-defined system acting on <code>target_system</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L222-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}" href="#FastMultipole.nearfield_device!-Tuple{Any, Tree, Any, Any, Tree, Any}"><code>FastMultipole.nearfield_device!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearfield_device!(target_systems, target_tree, derivatives_switches, source_systems, source_tree, direct_list)</code></pre><p>User-defined function used to offload nearfield calculations to a device, such as GPU.</p><p><strong>Arguments</strong></p><ul><li><code>target_systems</code>: user-defined system on which <code>source_system</code> acts</li><li><code>target_tree::Tree</code>: octree object used to sort <code>target_systems</code></li><li><code>derivatives_switches::Union{DerivativesSwitch, NTuple{N,DerivativesSwitch}}</code>: determines whether the scalar potential, velocity, and or velocity gradient should be calculated</li><li><code>source_systems</code>: user-defined system acting on <code>target_system</code></li><li><code>source_tree::Tree</code>: octree object used to sort <code>target_systems</code></li><li><code>direct_list::Vector{SVector{2,Int32}}</code>: each element <code>[i,j]</code> maps nearfield interaction from <code>source_tree.branches[j]</code> on <code>target_tree.branches[i]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/fmm.jl#L203-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.reset!-Tuple{ProbeSystem}" href="#FastMultipole.reset!-Tuple{ProbeSystem}"><code>FastMultipole.reset!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset!(probes)</code></pre><p>Zeroes all values (e.g. scalar/vector potential, velocity, and/or velocity gradient) of all probes.</p><p><strong>Arguments</strong></p><ul><li><code>probes::ProbeSystem</code>: a <code>::</code><a href="#FastMultipole.ProbeSystem"><code>ProbeSystem</code></a> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/probe.jl#L146-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.resort!-Tuple{Tuple, MultiTree}" href="#FastMultipole.resort!-Tuple{Tuple, MultiTree}"><code>FastMultipole.resort!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs the same sort operation as the tree. (Undoes <code>unsort!</code> operation.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/tree.jl#L479-L481">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_multipole_y!-NTuple{8, Any}" href="#FastMultipole.rotate_multipole_y!-NTuple{8, Any}"><code>FastMultipole.rotate_multipole_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Rotate solid harmonic weights about the y axis by θ. Note that Hs<em>π2 and ζs</em>mag must be updated a priori, but Ts is updated en situ. Resets rotated_weights before computing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L861-L863">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.rotate_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.rotate_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs a z-axis rotation of the supplied solid harmonic coefficients. Computes e^{imϕ} as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L445-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH" href="#FastMultipole.rotate_z_n!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Any, Any, Any, Val{LH}, Any}} where LH"><code>FastMultipole.rotate_z_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs a z-axis rotation of the supplied solid harmonic coefficients. Computes e^{imϕ} as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L500-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.shrink_branch!-Tuple{Any, Any, Any}" href="#FastMultipole.shrink_branch!-Tuple{Any, Any, Any}"><code>FastMultipole.shrink_branch!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the smallest bounding box to completely bound all child boxes.</p><p>Shrunk radii are merely the distance from the center to the corner of the box.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/tree.jl#L836-L840">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.source_to_dipole!-NTuple{7, Any}" href="#FastMultipole.source_to_dipole!-NTuple{7, Any}"><code>FastMultipole.source_to_dipole!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>assumes source expansion coefficients have already been calculated</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/bodytomultipole.jl#L239-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.source_to_vortex_point!-NTuple{7, Any}" href="#FastMultipole.source_to_vortex_point!-NTuple{7, Any}"><code>FastMultipole.source_to_vortex_point!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>might be slightly faster than mirrored<em>source</em>to_vortex</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/bodytomultipole.jl#L327-L329">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_local_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L504-L506">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_multipole_to_local_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_to_local_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L181-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH" href="#FastMultipole.translate_multipole_to_local_z_m01_n-Union{Tuple{LH}, Tuple{Any, Any, Any, Val{LH}, Any, Any}} where LH"><code>FastMultipole.translate_multipole_to_local_z_m01_n</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function should receive n!<em>t</em>np1 = 1/t when n=0</p><p>Calculates ϕn0, ϕn1, χn1 for P=n</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L236-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH" href="#FastMultipole.translate_multipole_z!-Union{Tuple{LH}, Tuple{Any, Any, Any, Any, Val{LH}}} where LH"><code>FastMultipole.translate_multipole_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Overwrites translated_weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/translate.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.unsort!-Tuple{Tuple, MultiTree}" href="#FastMultipole.unsort!-Tuple{Tuple, MultiTree}"><code>FastMultipole.unsort!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Undoes the sort operation performed by the tree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/tree.jl#L449-L451">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF" href="#FastMultipole.update_Ts_0!-Union{Tuple{TF}, Tuple{Any, Any, TF, Any}} where TF"><code>FastMultipole.update_Ts_0!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns sβ, cβ, and <em>1</em>n appropriate for calling update<em>Ts</em>n! for n=1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L348-L350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_eimϕs_0!-Tuple{Any, Any}" href="#FastMultipole.update_eimϕs_0!-Tuple{Any, Any}"><code>FastMultipole.update_eimϕs_0!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns eiϕ<em>real, eiϕ</em>imag, eimϕ<em>real, and eimϕ</em>imag appropriate for inputs for n=1 in update<em>eimϕs</em>n!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L38-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.update_eimϕs_n!-NTuple{6, Any}" href="#FastMultipole.update_eimϕs_n!-NTuple{6, Any}"><code>FastMultipole.update_eimϕs_n!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns eimϕ<em>real and eimϕ</em>imag for n</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/877c1ac7c9ee555a765564dddb28729bfbf891f6/src/rotate.jl#L49-L51">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advanced_usage/">« Advanced Usage</a><a class="docs-footer-nextpage" href="../theory/">Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 11 June 2025 03:10">Wednesday 11 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
