using FastMultipole
using FastMultipole.StaticArrays

# local_expansion_real = [0.0007304189061878632, 2.6181309188492824e-5, -2.8305341814115658e-5, -9.851913916645185e-8, -3.044302307728944e-6, 6.56906411760827e-7, -4.356416218985083e-7, -2.067796993022506e-7, 1.1781894495195469e-7, 8.942250562413789e-7, -1.0578550455997353e-7, 4.535190649531797e-8, 1.6458925770122264e-8, 2.244551573858388e-7, -5.478467021606633e-7, -6.2913318945079945e-9, 2.702427686594662e-8, -3.3809934558380917e-10, 4.7435435422873546e-8, -1.7684328726345957e-7, 2.2999623560255234e-7, 8.086822467752775e-9, 6.308870410126245e-9, -1.5155917275592239e-9, 4.361317588145358e-9, -5.006517178984576e-8, 9.076219134682003e-8, -4.9368084227121736e-8, 4.674776517514757e-9, -8.405260378249454e-10, -6.634978581549077e-10, -3.0861314263505452e-9, -9.203747681309503e-9, 3.221235152351785e-8, -2.303496231272998e-8, -3.937122950587686e-8, 9.295849888752624e-10, -1.6631901518578334e-9, -8.40847950805411e-11, -2.357486043857186e-9, 1.6557673844280129e-9, 8.62067156791257e-9, -9.832586388445787e-9, -2.1184329433707807e-8, 7.19981245931732e-8, -6.303263373777468e-10, -8.020124108741314e-10, 1.0809835106937436e-10, -7.581326633730433e-10, 2.776933181799831e-9, 2.3045098263261734e-10, -3.4168832737155904e-9, -1.0556398439173249e-8, 4.3924219292820935e-8, -6.783950403495566e-8, -7.308127821406477e-10, -1.3886479326117036e-11, 9.961273990486287e-11, 1.6271842354122622e-10, 1.4615626123744942e-9, -1.7753092888890378e-9, -5.57857272241504e-10, -4.4825015564394855e-9, 2.5049735331469818e-8, -4.626967907319691e-8, 3.699704757780915e-8, -2.979634622559637e-10, 3.0746192642907966e-10, 3.347032627837514e-11, 3.987277360143979e-10, 1.6687563682533175e-10, -1.4065797489197321e-9, 4.5570013924976703e-10, -1.2218876937758198e-9, 1.2545581483241868e-8, -2.9716351712723657e-8, 2.7901774078466765e-8, 1.318086855052863e-8, 1.084394934554995e-10, 2.602774122191369e-10, -1.9093306883687832e-11, 2.5588345995563345e-10, -4.770239973742144e-10, -4.777964248910773e-10, 5.661914262428799e-10, 2.840298657029061e-10, 4.635189145807771e-9, -1.7118056411509903e-8, 1.993118852733293e-8, 1.0871717416674428e-8, -7.21849911064251e-8, 2.6915153636496817e-10, 5.717449049157802e-11, -3.5913321593637126e-11, 1.3747880676791511e-11, -5.133224228201413e-10, 2.4228272028500227e-10, 3.106580951675605e-10, 7.195563293190172e-10, 1.3670116671791943e-10, -7.85749639853331e-9, 1.2970246015072942e-8, 8.533923262554474e-9, -6.479543257569143e-8, 1.1976418650544343e-7, 1.8715722022735956e-10, -1.1992475287305681e-10, -2.2153761333826952e-11, -1.507841878023044e-10, -2.0455294721304208e-10, 5.105000349222778e-10, -1.0159021445178366e-12, 5.602518977109357e-10, -1.8183239066442701e-9, -1.5752102791964434e-9, 7.058601988487317e-9, 6.17435798001868e-9, -5.557885402570182e-8, 1.1614522087242501e-7, -1.1894798745330831e-7, -1.6896859442337247e-11, -1.6944320115875038e-10, 4.616251654344601e-12, -1.6713020646534426e-10, 1.5775125867040454e-10, 3.649346709396255e-10, -2.00494375421345e-10, 1.5877329065460433e-10, -1.9643793571780513e-9, 1.9844911265716196e-9, 2.354005074047126e-9, 3.858481183458852e-9, -4.4356045257515805e-8, 1.0800200208583783e-7, -1.2394806721804608e-7, 1.299484624848321e-8, -1.8772136805045751e-10, -8.062492326789928e-11, 2.4786638310338178e-11, -5.5172122974233595e-11, 3.4691261091239437e-10, -3.78881592263637e-12, -2.2228682942398726e-10, -2.188409390035308e-10, -1.0106461977040376e-9, 3.1179789487907617e-9, -9.213280097183242e-10, 1.7174690096610098e-9, -3.1306750629416945e-8, 9.414496906372064e-8, -1.2421059339818813e-7, 1.4551249983351641e-8, 2.6018043560948127e-7, -2.0482387619154198e-10, 7.79810484311902e-11, 2.4678011775088727e-11, 1.0035262602803829e-10, 2.587001846735885e-10, -3.4283260527099964e-10, -8.614780539488752e-11, -3.908550422109783e-10, 3.168411061643351e-10, 2.2989001233021225e-9, -2.5661174244508073e-9, -5.4592369545941026e-11, -1.715417887493565e-8, 7.385707717244996e-8, -1.1740445311903574e-7, 1.5712714843853875e-8, 3.08415482057474e-7, -7.050235335822092e-7, -3.931628775702426e-11, 1.9112183666569204e-10, 2.61625980322145e-12, 1.8798808704663244e-10, -5.543304370451354e-11, -4.2645767354704777e-10, 1.1768822921634636e-10, -2.7989035953714194e-10, 1.3107494761277324e-9, 2.8370347886953114e-10, -2.525201681203823e-9, -1.2248400298840738e-9, -3.3313892335531747e-9, 4.746725718528606e-8, -1.012251204199946e-7, 1.609065494747314e-8, 3.532662197243594e-7, -8.867819696463454e-7, 1.1023082401849713e-6, 2.14358311697254e-10, 1.5248185377096596e-10, -2.8258986048140222e-11, 1.225286123946798e-10, -3.935852826840786e-10, -1.543490849699804e-10, 2.5597397669573165e-10, 6.006113374931499e-11, 1.4092842932427558e-9, -1.8671219717653415e-9, -1.0448118964783077e-9, -1.5803404896456417e-9, 7.973995368103228e-9, 1.708472688458068e-8, -7.41637385955281e-8, 1.520078864715198e-8, 3.852582811147616e-7, -1.0799367374822383e-6, 1.4662919547208228e-6, -6.851052226863203e-7, 3.568891429455434e-10, -6.314061138496983e-11, -4.330127209237111e-11, -9.444130214486209e-11, -4.737883636958573e-10, 3.5980003182119995e-10, 2.04536190646106e-10, 4.347247548193874e-10, 4.080839527859852e-10, -2.9325429788579356e-9, 1.1863083745802372e-9, -1.0305196632337574e-9, 1.4066606692130156e-8, -1.269429954030663e-8, -3.676643165332268e-8, 1.25452246576372e-8, 3.906402795996641e-7, -1.2568330092605526e-6, 1.8917963057771638e-6, -9.61620712055405e-7, -2.2637395592205857e-6]

# local_expansion_imag = [-1.2711890174907814e-26,-3.3336018181978886e-27,2.532506910768773e-5,-2.5255930674008087e-29,2.723635938068359e-6,-5.890063700068195e-6,2.1675720384063562e-27,1.849874075197021e-7,-1.055955875456142e-6,1.2559352221457453e-6,-9.895835532782522e-29,-4.057249295589994e-8,-1.4744105901096329e-7,3.152926794425943e-7,-1.2383147418617876e-7,1.962657040605675e-31,-2.41747257598909e-8,3.035654874317664e-9,6.66435088372178e-8,-3.9989356353999966e-8,-1.2787593896526042e-7,-7.414859674559518e-29,-5.643249154163988e-9,1.3569969210802324e-8,6.129281592892885e-9,-1.1326371246584222e-8,-5.04497224188792e-8,1.4242294157194092e-7,1.9621537748121813e-28,7.519317875681559e-10,5.93722531222611e-9,-4.336293501950528e-9,-2.0835262587963823e-9,-1.7900029917345193e-8,6.642574529774671e-8,-9.417175320927427e-8,-4.040009832273401e-31,1.4876575549543694e-9,7.513809475909669e-10,-3.3132569165879843e-9,3.744704398566358e-10,-4.78871366697996e-9,2.8341339379432966e-8,-5.0692109678792815e-8,3.435104090066112e-8,2.1489262801905598e-30,7.17311924504453e-10,-9.671569167992514e-10,-1.0657808903675044e-9,6.287927480729804e-10,-1.2749903648136345e-10,9.843508794867989e-9,-2.527178805779227e-8,2.0965805496582824e-8,1.9833884842997444e-8,5.3102534245031325e-30,1.2395264002161163e-11,-8.905265496500546e-10,2.2861059124177604e-10,3.311769149745835e-10,9.860806120208345e-10,1.6051455099333876e-9,-1.0736536396175765e-8,1.1962153444719072e-8,1.3518266779086925e-8,-5.94358033406016e-8,-1.9479919559874702e-31,-2.7498951259662674e-10,-2.988916100111724e-10,5.605383517631997e-10,3.7921873758089446e-11,7.809132013908681e-10,-1.313043288821104e-9,-2.929134455616257e-9,5.994052258427428e-9,8.675694969411144e-9,-4.480396414684835e-8,7.552704914871882e-8,-1.1247922917327891e-31,-2.32765908631713e-10,1.708017453661332e-10,3.5983168247447355e-10,-1.0807580999167144e-10,2.6507974869449724e-10,-1.6298230806303304e-9,6.793777106216124e-10,2.216213829547049e-9,4.993589960231312e-9,-3.19898444055967e-8,6.23760449964722e-8,-5.70107816583652e-8,8.557171316195476e-31,-5.111723877320346e-11,3.2081130033418376e-10,1.9402765822655258e-11,-1.1640970688922844e-10,-1.3459229768464333e-10,-8.934594880026565e-10,1.724579639576031e-9,6.62821576900096e-11,2.2897438841463192e-9,-2.0806616920815594e-8,4.902931085639412e-8,-5.119919055645648e-8,-7.3186935898288995e-9,-1.4126816400971007e-30,1.0725396291314998e-10,1.9768083803462859e-10,-2.1201499760978158e-10,-4.645598441525095e-11,-2.8330086631797124e-10,3.5020342893448586e-12,1.343913490314996e-9,-8.690968161164639e-10,4.575736791575158e-10,-1.1315996708395654e-8,3.552542071212032e-8,-4.393858074010346e-8,-7.068656550484895e-9,1.2017552731753977e-7,-3.9368971408285008e-31,1.5152020242922201e-10,-4.140248956997772e-11,-2.350862434135153e-10,3.573344079983882e-11,-2.0238489598262012e-10,5.768780925125349e-10,3.816723170739452e-10,-9.398152735344025e-10,-5.790243045550037e-10,-3.769010957278874e-9,2.2239838293320542e-8,-3.5085272257909085e-8,-6.5450515815156086e-9,1.2516183051794642e-7,-2.5567513301088416e-7,-2.2759112375895642e-29,7.208244689779369e-11,-2.2129420354193919e-10,-7.767377754733682e-11,7.872125271474667e-11,2.2270320733950467e-12,6.388814475448073e-10,-5.244420965403703e-10,-4.841567039510257e-10,-9.078606345237849e-10,1.4803948738863543e-9,9.92792471800974e-9,-2.4779101738962123e-8,-5.6790089370199376e-9,1.2535871527134243e-7,-2.8476067231105916e-7,3.2260734237987463e-7,5.704977088305597e-29,-6.974392542891602e-11,-2.2005443960266538e-10,1.4110693271097112e-10,5.878299535126843e-11,1.9021047104934319e-10,2.4702769775767473e-10,-9.38084586665077e-10,1.5103271010201166e-10,-6.681966229772157e-10,4.112508802859599e-9,-2.8887581703413283e-10,-1.3589977468331277e-8,-4.431490749412554e-9,1.1842053193450587e-7,-3.057811427537478e-7,3.8263912556997307e-7,-1.1569508289339443e-7,3.214627105727391e-30,-1.7089497589288543e-10,-2.3043739589818575e-11,2.644792976904376e-10,-1.2496738298915309e-11,2.3641673892868716e-10,-3.3873629332920724e-10,-6.72719803276423e-10,6.273151830638295e-10,-8.128973373677744e-11,4.042430041627781e-9,-7.0597247476614495e-9,-2.6505142375018935e-9,-2.8274103679669092e-9,1.0203357296122144e-7,-3.112859411523789e-7,4.385500829680497e-7,-1.4579162481680647e-7,-7.015733335360217e-7,6.620031658088454e-30,-1.363192654680337e-10,2.522358213957811e-10,1.7249966505493064e-10,-8.934435847672044e-11,8.538033921907852e-11,-7.353526030039427e-10,1.4308073176962365e-10,6.753625615287658e-10,5.437210988062917e-10,1.668353306921943e-9,-9.141334821737466e-9,6.307206505663098e-9,-9.986039428767944e-10,7.469211643446776e-8,-2.921316570721221e-7,4.785756648726575e-7,-1.7788903610676925e-7,-9.326026744254997e-7,2.4322714543409337e-6,5.988318037491601e-29,5.648818767899308e-11,3.8590966932583906e-10,-1.3273941717766732e-10,-1.0771001119523752e-10,-1.9965375640238834e-10,-5.865608135830586e-10,1.043602054130374e-9,1.965322510926927e-10,8.518961826306458e-10,-1.9035029116888268e-9,-5.989743527803963e-9,1.1145476356725204e-8,7.760071397256155e-10,3.696652943242879e-8,-2.391284929874553e-7,4.85612020107615e-7,-2.074511438302133e-7,-1.2023889952298493e-6,3.4098345651921116e-6,-4.628549724546777e-6]

# from runtests.jl

local_expansion_real = [0.6571772625202524,  -0.23282477465547463,   0.36586680614319994,  -0.19601793982238958,  -0.3888578997736565,   0.13915768360821643,   0.9756813165193983,  -0.05185490876916539,  -0.24650393566121262,  -2.239841065950207,  -1.2291671927619745,   2.227856978931834,   0.1417910906929372,   5.554716586067292, -20.13302943533198,  -6.615254430961278,  -6.578679479744814,   1.5440325221592504,  -7.1309688768674295,  64.19457089999177,-124.24209327876447,  46.51670579255137, -10.443779201293205,  -8.026558126514331, -32.18458850713602,-127.89666084635404, 484.18140617589444,-426.85942663766076, -53.53245688834107, 203.47912340439566,   3.6254502426211284, 278.157032382772,-277.34388543194194,1307.7199198219066,1965.960968673052,3580.502976181725,1253.6374326173548,-743.042840096575, 224.4737131480975,-609.4357543700391,4321.980613371367,-892.1098304199606,6702.842467521838,9027.51006750807,5523.1407756448,9862.328050929442,4175.416305240932,1498.7419951906231,6653.272544279706,7046.767088711098,9789.28365724816,3223.1048326716373,8355.44699287241,5540.5897987762,   1.495881941018085e6,2137.4070243021492,8219.41423021078,1575.3206058038886,4395.79352755248,4827.83196378595,4121.88008187982,1847.45446623763,6553.70762980469,   3.067480178399336e6,  -1.0069260636572825e7,   1.2923818673579963e7,1427.2891888542,8598.3355254006,8812.14027568662,4930.21641468155,   1.522997704201715e6,1943.2626190858,  -1.4921234028373263e6,  -1.8295035409805903e6,  -7.382269510423468e6,   5.573465175247301e7,  -9.615166589198081e7,  -2.5663846018302012e7,   5.378044700284259e6,  -3.6615426806393564e6,2272.3008808473,  -4.441829879415022e6,  -7.108082753597492e6,   1.7382865762663778e7,   1.7278320489334688e6,   2.057056307770069e7,  -5.783506628956294e7,  -1.823547455333624e8,   6.003410568957736e8,   2.0912032210465592e8,  -4.086084549937773e9,   1.8583288826105844e7,   5.448971035311851e7,  -3.5284912791750613e6,   5.2544446795051694e7,  -6.85947522409089e7,  -1.321221777194172e8,   9.344266328753188e7,  -6.490863092815118e7,   9.107788361103791e8,  -7.543523437053907e8,  -2.4622969177144485e9,  -1.4538564683626337e9,   3.6190453048927605e10,  -1.0563532760867682e11,  -7.910923828983669e8,  -1.0611914546225657e8,   1.1862687587428866e8,  -2.3030546572412282e7,   1.3900339122274783e9,  -4.253301638053179e8,  -1.0489051924570957e9,  -1.0448728683703936e9,  -4.614169891165265e9,   1.804471507644108e10,  -4.399993978323966e9,   7.13330511537961e9,  -2.7724813581483136e11,   1.0104611255102817e12,  -1.6606973374733699e12,   5.669881266422501e9,  -6.079967391600239e9,  -7.616193188224573e8,  -6.3939918487366085e9,  -5.949391053863434e9,   1.9615928595061485e10,   6.875284574671705e8,   1.7173948880916056e10,  -3.3721681615570496e10,  -1.2685297941204039e11,   2.047193096288982e11,   2.929346411382546e8,   1.5785429976331543e12,  -8.456921710619072e12,   1.7062204761431148e13,  -8.189913936278254e12,   5.78438296345578e10,   8.281517069189038e10,  -9.326706898409979e9,   7.358010679105617e10,  -1.3070518727450902e11,  -1.580315977004003e11,   1.262266092303806e11,  -6.451901878235076e10,   8.716623518704402e11,  -3.6028126875877454e11,  -1.877218756939225e12,  -5.0383839270491437e11,  -2.1822339613491006e12,   5.469467705446322e13,  -1.5488947892286988e14,   8.99472094329976e13,   5.3739785208413244e14,  -1.6557538966657126e12,   7.801632849005495e10,   2.385568210690716e11,   2.0550425222522937e11,   2.4916437945255195e12,  -1.210192440376951e12,  -1.5778157494835068e12,  -1.6446669206551816e12,  -5.821678643127579e12,   1.9192548655238137e13,   3.9596356003242114e11,   5.863809551772971e12,  -9.37922185818545e13,  -1.4295161416996634e14,   1.1200197119343342e15,  -8.80267355910683e14,  -6.282847644417636e15,   2.434825548669741e16,   9.250216708460406e12,  -1.706225692514318e13,  -1.1643220881242534e12,  -1.645105192267586e13,  -6.816769715827343e12,   4.315968067820809e13,  -1.9858579233149653e12,   3.0842767089137145e13,  -6.0159890132905516e13,  -1.8741411121261072e14,   2.3451087316660625e14,  -1.559040877616412e13,   1.376532608100288e15,  -2.6564867211165695e15,  -4.1674911225823915e15,   7.030482160332551e15,   6.593879277504172e16,  -3.019135166547765e17,   6.079209882864428e17,   2.4075925032670822e14,   2.06653357615945e14,  -3.6251839045520875e13,   1.7196292231855728e14,  -4.2851451906937106e14,  -3.21572318210116e14,   3.326749094307789e14,  -9.909024371705506e13,   1.810022962385868e15,  -6.905057870057379e14,  -3.1339064660725695e15,  -5.989042444204501e14,  -6.651445445827149e15,   4.977441214673987e16,  -4.2114283187851704e16,  -3.3350304492454064e16,  -5.7604558074985536e17,   3.382520951893945e18,  -7.968847648263266e18,   7.72489029895832e18,  -5.579982132062743e15,   1.2896824049010622e15,   7.813846379466742e14,   1.531703766297454e15,   7.507772656575082e15,  -5.342801537950837e15,  -4.161014348194834e15,  -5.124589779690138e15,  -1.2951685600293326e16,   4.495225182058229e16,   1.9972739359838152e15,   1.0799968612994686e16,  -1.0967002309594315e17,  -3.435425092326541e17,   1.0459172087391692e18,  -1.844233877796548e17,   3.287041276713149e18,  -3.2067036761179013e19,   9.492625919353225e19,  -1.0673419772869037e20,  -1.4641380491770823e20]

local_expansion_imag = [-0.0, 0.0,-0.3215194623139582,0.0,0.3417237660057804,-1.0739869331927323,-0.0,0.04556948623340229,1.902460568588344,-3.3299849040641214,0.0,-1.957814608899512,-1.0943109622038063,8.258229862444123,-5.306405626026002,0.0,5.781266443273747,-11.916487183649423,-10.601653426354098,16.91958149061458,62.061654303635365,-0.0,9.177870790528129,61.9471258996966,-47.84901728141684,-33.70936116916484,-241.8592463901478,1048.6943056225705,0.0,-178.81506944767912,-27.98038948735141,413.5376982209939,-73.09874347162302,653.234821212053,-4829.908734037935,10304.73668282869,0.0,652.9773415153189,-1732.4363880980543,-906.0517252317737,1139.1322064091028,445.6284535722767,16467.32457695505,-54761.43499387253,59777.47228808806,-0.0,3669.30692497027,11566.945333709873,-9891.459475352007,-4492.968188202517,-19875.621073003065,-7918.418742844089,225508.05132633718,-360025.3907853733,-311896.9145837372,-0.0,-59950.42188682639,12157.961402878227,110604.66438386496,-19722.160035147972,116949.02108545101,-446756.89018478827,-335443.16944357165,1.737687203116754e6,2.0994780661293995e6,-1.720432289183911e7,0.0,200889.53873346257,-839787.0228843188,-215468.60629546316,401412.1974022438,135841.632328269,3.6658000695154853e6,-5.265336288091059e6,-4.181958647542347e6,-1.1620880926715625e7,1.2799810554256582e8,-3.339201770965472e8,-0.0,3.217720804816597e6,5.883041952506683e6,-6.603694641431224e6,-1.873457267576194e6,-8.683123225784613e6,-4.244881377134947e6,5.9202362724824406e7,-3.2762804888025362e7,3.802163856116145e7,-7.991803079980701e8,2.7209286925223613e9,-3.9869521545898395e9,-0.0,-4.788491899295414e7,2.7232082551672872e7,7.811813850537388e7,-1.8079324841607813e7,6.599792955088148e7,-2.2956688496661222e8,-1.8680793022850454e8,5.159442396802806e8,1.572852523044649e8,3.277835467820366e9,-1.8916572716435406e10,3.53124373701963e10,-5.513647224507504e9,0.0,9.32562616158383e7,-9.155348904279962e8,-3.423964922526493e7,3.663673068130692e8,2.1246175828483066e8,2.576916037985078e9,-3.00715844874705e9,-2.6138665962198424e9,-3.7623897999959702e9,5.857318106759251e9,9.281362215595392e10,-2.7052182570715332e11,5.274112653658178e10,1.3125179255390024e12,-0.0,5.34300410370814e9,5.878002387459778e9,-9.50598533828082e9,-1.5680641734048667e9,-9.7985871549991e9,-1.6890974716866627e9,4.942686047168876e10,-1.910288940857367e10,2.644931514945764e10,-2.7252449094245328e11,3.8114625211218157e9,1.540246005340749e12,-4.414099333356171e11,-1.3484967485205234e13,4.475268107082406e13,-0.0,-7.277700164434598e10,7.198137450183456e10,1.0939197810881192e11,-3.444959653647873e10,7.894025387617772e10,-3.1010941321042993e11,-1.8568662112818738e11,4.9378526549250635e11,7.511997640114397e10,2.498973287130857e12,-6.555595961730915e12,-2.129290837643684e12,2.854794519630996e12,1.2241557385342781e14,-4.915044050871691e14,8.965752275160039e14,0.0,-6.855983534623758e10,-1.8411265695791738e12,3.0552438207962225e11,6.567155078072819e11,6.045177032475548e11,3.8763262295470103e12,-4.733373959203821e12,-3.297904433110221e12,-4.0017173444135176e12,-5.271108417921538e11,7.629582575394538e13,-9.151672790627419e13,-7.46137479335428e12,-8.85197992252707e14,4.810102345718951e15,-1.0482076797285466e16,7.795502715819855e15,-0.0,1.4994111464398576e13,8.985969558056746e12,-2.4457875780237832e13,-1.7966767141317412e12,-2.155920840850854e13,4.878790922716683e12,8.876590678394177e13,-3.407978703856208e13,3.907653500842683e13,-3.121833326130857e14,-2.0285159347635166e14,1.3431365848296488e15,-1.386556085771284e14,3.293740936103452e15,-3.841712237069728e16,1.1000990775295891e17,-9.666268042533467e16,-2.6502937872918106e17,-0.0,-1.8160454927973706e14,2.7978333951512172e14,2.5565828936912475e14,-1.129423598235574e14,1.6063243559166562e14,-8.173048581628345e14,-2.8518308073869556e14,1.025354217847513e15,1.439730092086867e14,4.1718891387230905e15,-7.792526935289884e15,-6.490074893771149e15,2.5979807664441105e15,3.328466323031458e16,1.8223824477011686e17,-9.610537065182285e17,1.0829708634038742e18,3.4741007171997455e18,-1.6463873960257665e19,0.0,-1.133357785995118e15,-6.030546565541656e15,2.2771930101678335e15,1.9788024048610985e15,2.66884671137387e15,1.0222644224909666e16,-1.4748639685125002e16,-7.336959659887762e15,-9.372710681224336e15,-2.6587919999500875e15,1.4052170626789555e17,-1.070093214010823e17,-1.7931238018666222e16,-8.266317131503749e17,1.0077567505006547e18,5.48398131681071e18,-1.0266800112091855e19,-4.138407454899861e19,2.2748004316531714e20,-5.0486258986995705e20]

local_expansion = zeros(2,4,length(local_expansion_real))
local_expansion[1,1,:] .= local_expansion_real
local_expansion[2,1,:] .= local_expansion_imag

#expansion_center = SVector{3}(
#    10.000000014901161,
#    10.000000014901161,
#    10.000000014901161
#	)
expansion_center = SVector{3}(
 0.37499725000000006,
 0.37499725000000006,
 0.2749972500000001
 )

# target = [10.0,10,10]
target = [ 0.1, 0.3,0.2]
derivatives_switch = FastMultipole.DerivativesSwitch(true,true,true,true)
P = 20

scalar_potential, vector_potential, velocity, gradient = FastMultipole.L2B(target, expansion_center, local_expansion, derivatives_switch, Val(P))


#=
potential_source_check = 0.0007304189073771653
potential_source_fmm = 0.0007304189073771506
velocity_source_check = [
 2.8305341908986337e-5
 2.532506918799478e-5
 2.618130927297992e-5
]
velocity_source_fmm = [
 2.830534190899204e-5
 2.5325069187997148e-5
 2.618130927297376e-5
]
gradient_source_check = [
     -3.77713e-7  -2.94503e-6  -3.0443e-6;
 -2.94503e-6   2.79194e-7  -2.72364e-6;
 -3.0443e-6   -2.72364e-6   9.85191e-8;
]

@show velocity_source_check - velocity
@show potential_source_check - scalar_potential
@show gradient_source_check - gradient
=#
