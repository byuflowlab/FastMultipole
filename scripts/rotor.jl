cwblade1 = [0.002710375795415232 0.0041901014780335605 0.006239999999999799
    0.0022708283350397485 0.0044107356140865505 0.016581818181817656
    0.0014272411310406452 0.004720642529118642 0.0264337607655494
    0.0012133731575764168 0.00469738771897025 0.035795827751195046
    0.0016927815281018814 0.004609512928482118 0.04466801913875458
    0.002119011974764235 0.004502040851690745 0.05305033492822799
    0.0022967770867486723 0.0042844789983864946 0.06094277511961531
    0.002386138740226943 0.004264257896967722 0.06834533971291652
    0.0024632392495083167 0.004261894399620499 0.07525802870813161
    0.0025338081519656335 0.004120896995172799 0.08168084210526061
    0.002639950720498341 0.0040926838652767545 0.08761377990430348
    0.002750637321794694 0.004168380304868007 0.09305684210526025
    0.0028506673832594293 0.004251535776838914 0.0980100287081309
    0.0029428164703274723 0.004302176643788189 0.10247333971291543
    0.003012503737776999 0.004310601974795263 0.1064467751196139
    0.0030671095645841123 0.0043033915091469765 0.10993033492822621
    0.0031110495178839487 0.0043332221260002175 0.11292401913875244
    0.003134536058604427 0.004246206254571631 0.11542782775119255
    0.0031279891496145246 0.0037253577551024574 0.11744176076554654
    0.0030972023608013812 0.002681083274727067 0.11896581818181447
    0.003061355403088506 0.0014324016127841394 0.11999999999999625]

cwblade2 = [0.002710375795415232 0.00722940522654941 -0.002056757269722188
    0.0022708283350397485 0.01713323849628641 0.0009292047683849014
    0.0014272411310406452 0.026598759192129253 0.003678883463377946
    0.0012133731575764168 0.03549542787328229 0.006594037903145828
    0.0016927815281018814 0.0439062285026004 0.00941926971136049
    0.002119011974764235 0.0518450738576734 0.012111759761477355
    0.0022967770867486723 0.059284000221163216 0.014757571525986076
    0.002386138740226943 0.06631800885093461 0.017064321197545338
    0.0024632392495083167 0.07289163640410914 0.019202707393448735
    0.0025338081519656335 0.07895652434425927 0.021321562385141303
    0.002639950720498341 0.08459036516221034 0.023181773272647706
    0.002750637321794694 0.08979041642327738 0.024791780402049594
    0.0028506673832594293 0.09452687327237758 0.02624331368516336
    0.0029428164703274723 0.09878738317622691 0.02757439031031952
    0.003012503737776999 0.10256894838230969 0.02879423641108421
    0.0030671095645841123 0.10587978248177161 0.029877573153207247
    0.0031110495178839487 0.10873616352548278 0.030774301847508394
    0.003134536058604427 0.11109053763884805 0.03163077827095798
    0.0031279891496145246 0.11284495071770068 0.032748474157348814
    0.0030972023608013812 0.11397171689342213 0.03421259784874049
    0.003061355403088506 0.11456941839653316 0.035719744437201315]

cwblade3 = [0.002710375795415232 0.0002779166704201736 -0.0075111458992964345
    0.0022708283350397485 0.006178188113976693 -0.016007538052447035
    0.0014272411310406452 0.011718294710191073 -0.02416008574453146
    0.0012133731575764168 0.017239993151938773 -0.031720488203945234
    0.0016927815281018814 0.022526028603944533 -0.03884659030793064
    0.002119011974764235 0.027539976941600278 -0.045564855732060795
    0.0022967770867486723 0.032355048127348914 -0.051822094325147255
    0.002386138740226943 0.036722525639126515 -0.05779900921788707
    0.0024632392495083167 0.040787614393718426 -0.06339010286296015
    0.0025338081519656335 0.044676918683138264 -0.06850339185799065
    0.002639950720498341 0.0481870369257346 -0.07328665610231187
    0.002750637321794694 0.05132514890872455 -0.07773467917516853
    0.0028506673832594293 0.054169284755744805 -0.08179076887327306
    0.0029428164703274723 0.056751783818779995 -0.08543142928208053
    0.003012503737776999 0.059080494315806094 -0.0886509583374623
    0.0030671095645841123 0.06113391278603401 -0.09146497921818095
    0.0031110495178839487 0.06286942273901518 -0.0939044546169417
    0.003134536058604427 0.0644115218347364 -0.09587893168912699
    0.0031279891496145246 0.06601665724724386 -0.09720209065660548
    0.0030972023608013812 0.06775731152158883 -0.09782126986785934
    0.003061355403088506 0.06937539302758126 -0.09792398386834389]

cwblade4 = [0.002710375795415232 -0.007057643278189627 -0.00258538619050244
    0.0022708283350397485 -0.013314908252958398 -0.010822407361004514
    0.0014272411310406452 -0.019356454771043367 -0.01861063762461026
    0.0012133731575764168 -0.024840526139569087 -0.02619837775292416
    0.0016927815281018814 -0.029984377193810814 -0.03342778286870395
    0.002119011974764235 -0.03482443205837662 -0.040272389296376485
    0.0022967770867486723 -0.0392874807708236 -0.04678538718713022
    0.002386138740226943 -0.04362223985321569 -0.05278607341026813
    0.0024632392495083167 -0.04768350438876751 -0.05837994551311024
    0.0025338081519656335 -0.051344670085465484 -0.06365898689803245
    0.002639950720498341 -0.05480913852496104 -0.06847541766570146
    0.002750637321794694 -0.05806972992003702 -0.07283445423687251
    0.0028506673832594293 -0.06104841414705676 -0.07679278881483319
    0.0029428164703274723 -0.06371285185403565 -0.08037391731412845
    0.003012503737776999 -0.06605519482299768 -0.08358354179888693
    0.0030671095645841123 -0.06809694651473197 -0.08640603909034601
    0.0031110495178839487 -0.06988072341968707 -0.0888104464958005
    0.003134536058604427 -0.07128202787787616 -0.09088721685986798
    0.0031279891496145246 -0.07204441271525312 -0.09282266996067974
    0.0030972023608013812 -0.0720953953867666 -0.09466946744975364
    0.003061355403088506 -0.0716930675226067 -0.09624009478163438]

cwblade5 = [0.002710375795415232 -0.004639780096813534 0.00591328935952134
    0.0022708283350397485 -0.014407253971391337 0.009318922463249231
    0.0014272411310406452 -0.023681241660395747 0.012658079140214771
    0.0012133731575764168 -0.03259228260462243 0.015529000302529083
    0.0016927815281018814 -0.0410573928412165 0.018187084326520223
    0.002119011974764235 -0.049062659592588126 0.020675150338732764
    0.0022967770867486723 -0.0566360465760754 0.022907134866677056
    0.002386138740226943 -0.06368255253381357 0.025175421717694418
    0.0024632392495083167 -0.07025764080868102 0.02730931227449124
    0.0025338081519656335 -0.07640966993710535 0.02915997426562251
    0.002639950720498341 -0.0820609474282612 0.03096652059106354
    0.002750637321794694 -0.08721421571683352 0.03272051090473269
    0.0028506673832594293 -0.09189927965790515 0.034330215294813574
    0.0029428164703274723 -0.09612849178476009 0.035757616572975666
    0.003012503737776999 -0.09990484984991403 0.03699348860565283
    0.0030671095645841123 -0.10322014026222132 0.03806311022709526
    0.0031110495178839487 -0.1060580849708118 0.039016580126483194
    0.003134536058604427 -0.10846623785028064 0.03970754252684629
    0.0031279891496145246 -0.1105425530047946 0.039834525694391734
    0.0030972023608013812 -0.11231471630297217 0.039312321287059956
    0.003061355403088506 -0.11368414551429261 0.03844433421278264]

#=
g1_cw = [-0.003790722937951869
    0.06959399724311108
    -0.07674020454082481
    -0.10479653585357979
    -0.0430428218650725
    -0.015668951668649123
    -0.0007539349394123242
    0.01797892635653546
    -0.004847573476155897
    0.0061642809345436155
    -0.0022778889410045885
    -0.02120271992510551
    -0.01768699047253608
    -0.022021135005307918
    -0.02818114444870885
    -0.029064733320766947
    -0.01919313992736412
    -0.015200253622494763
    -0.013309765708549703
    -0.006772109339581456
   ]

g2_cw = [-0.0037944990044995026
    0.06442599783533048
    -0.07583178513651903
    -0.11584484473151724
    -0.04865728830277621
    -0.016683747024731865
    -0.0009339468000279061
    0.01698530470569392
    -0.006205670130341918
    0.0037026958598755984
    -0.005107159808764491
    -0.02354356446322016
    -0.020418380373129437
    -0.024044752062523926
    -0.029717043833349166
    -0.03028738286501941
    -0.019918750005342732
    -0.015705103241304367
    -0.013733623315796613
    -0.0069452776716732185
   ]

g3_cw = [-0.004196374611688787
    0.0821833322460401
    -0.08212384369032238
    -0.10907850901384161
    -0.03933296439640589
    -0.009090662143128564
    0.005648874429330973
    0.023909542231812055
    0.0006876404400445496
    0.011309318277643046
    0.002014299254437203
    -0.018569680785418978
    -0.014594237427836795
    -0.019130160378960794
    -0.02596790313322557
    -0.027171976633319286
    -0.01806704585288882
    -0.01447280856297942
    -0.01270780087457067
    -0.006548157473288836]

g4_cw = [-0.0044214442717335194
    0.09934929864637061
    -0.08553881072458158
    -0.09944702891504884
    -0.034452591023779136
    -0.007759628810616192
    0.004851077166546089
    0.022477084493995735
    -0.0005037794445322487
    0.010643239268761102
    0.001637038889675018
    -0.01866042851265937
    -0.014381722528054766
    -0.018835138126744512
    -0.025746039663449263
    -0.026935958338405522
    -0.01785382617775804
    -0.014292457694624375
    -0.01249372373820145
    -0.006456050892869577]

g5_cw = [-0.0042226204717173855
    0.09434655808339712
    -0.0832302635318657
    -0.09823671469192713
    -0.034906129215156345
    -0.011730641133178905
    0.0003960174928098136
    0.017721448747835253
    -0.004608376814528544
    0.006157348303237047
    -0.002584141508726578
    -0.021762000875715
    -0.01832406549878252
    -0.022398236227991912
    -0.028580187246975187
    -0.02936532541998128
    -0.01936074355154177
    -0.01531961353412853
    -0.013364777297907231
    -0.00679329508395183]
=#

g1_cw = [-0.01650475379313983, -0.04448481017785153, -0.06581182041218761, -0.08124718043485189, -0.09161669997815522, -0.09762792727233517, -0.09992935209385441, -0.09914049493715618, -0.09584503735867476, -0.0905871829134433, -0.08387134607968898, -0.07616175529013848, -0.06788271374663174, -0.05941881346771792, -0.05111465765954134, -0.04327463901144195, -0.03616342953308885, -0.030005037554567515, -0.024972816925022304, -0.021187823115392745]

g2_cw = [-0.016504753793139523, -0.044484810177850796, -0.06581182041218668, -0.08124718043485094, -0.09161669997815443, -0.09762792727233467, -0.09992935209385431, -0.09914049493715658, -0.09584503735867571, -0.09058718291344486, -0.08387134607969121, -0.0761617552901413, -0.06788271374663524, -0.05941881346772199, -0.05111465765954603, -0.043274639011447145, -0.03616342953309443, -0.030005037554573483, -0.024972816925028674, -0.02118782311539935]

g3_cw = [-0.016504753793139634, -0.04448481017785106, -0.065811820412187, -0.08124718043485128, -0.0916166999781547, -0.09762792727233485, -0.09992935209385434, -0.09914049493715643, -0.09584503735867538, -0.09058718291344428, -0.0838713460796904, -0.07616175529014031, -0.06788271374663399, -0.05941881346772057, -0.05111465765954435, -0.043274639011445265, -0.03616342953309243, -0.030005037554571304, -0.024972816925026356, -0.021187823115396978]

g4_cw = [-0.016504753793139607, -0.044484810177851025, -0.06581182041218696, -0.08124718043485123, -0.09161669997815466, -0.09762792727233482, -0.09992935209385434, -0.09914049493715647, -0.09584503735867544, -0.09058718291344439, -0.08387134607969055, -0.07616175529014046, -0.06788271374663424, -0.05941881346772081, -0.05111465765954464, -0.04327463901144565, -0.036163429533092845, -0.030005037554571762, -0.02497281692502687, -0.021187823115397506]

g5_cw = [-0.01650475379313958, -0.04448481017785099, -0.06581182041218693, -0.08124718043485119, -0.09161669997815464, -0.09762792727233481, -0.09992935209385433, -0.09914049493715647, -0.09584503735867547, -0.09058718291344446, -0.08387134607969063, -0.07616175529014058, -0.06788271374663433, -0.05941881346772095, -0.0511146576595448, -0.04327463901144582, -0.03616342953309298, -0.03000503755457193, -0.024972816925026994, -0.021187823115397714]

function generate_rotor()
    n_blades = 5
    n_per_blade = length(g1_cw)
    n_filaments = n_per_blade * n_blades
    pts = zeros(SVector{3,Float64}, 2, n_filaments)
    strength_vec = zeros(SVector{3,Float64}, size(pts,2))
    blades = [cwblade1, cwblade2, cwblade3, cwblade4, cwblade5]
    strengths = [g1_cw, g2_cw, g3_cw, g4_cw, g5_cw]
    i_offset = 0
    for i_blade in 1:5
        for i_filament in 1:n_per_blade
            pts[1,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament,:])
            pts[2,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament+1,:])
            Γ = pts[2,i_filament+i_offset] - pts[1,i_filament+i_offset]
            Γ *= strengths[i_blade][i_filament] / norm(Γ)
            strength_vec[i_filament+i_offset] = Γ
        end
        i_offset += n_per_blade
    end

    # create filaments
    core_size = fill(1e-2, length(strength_vec))
    error_tolerance = fill(1e-4, length(strength_vec))
    potential = zeros(length(strength_vec))
    force = zeros(SVector{3,Float64}, length(strength_vec))
    gradient = zeros(SMatrix{3,3,Float64,9}, length(strength_vec))

    return VortexFilaments(pts, strength_vec, core_size, error_tolerance, potential, force, gradient)
end

function generate_rotor_blade_filament(; i_blade=1, i_filament=1)
    n_per_blade = length(g1_cw)
    n_blades = 1
    n_filaments = n_per_blade * n_blades
    pts = zeros(SVector{3,Float64}, 2, 1)
    strength_vec = zeros(SVector{3,Float64}, size(pts,2))
    blades = [cwblade1, cwblade2, cwblade3, cwblade4, cwblade5]
    strengths = [g1_cw, g2_cw, g3_cw, g4_cw, g5_cw]
    i_offset = 0

    pts[1,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament,:])
    pts[2,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament+1,:])
    Γ = pts[2,i_filament+i_offset] - pts[1,i_filament+i_offset]
    Γ *= strengths[i_blade][i_filament] / norm(Γ)
    strength_vec[i_filament+i_offset] = Γ

    # create filaments
    core_size = fill(1e-2, size(pts,2))
    error_tolerance = fill(1e-4, size(pts,2))
    potential = zeros(length(strength_vec))
    force = zeros(SVector{3,Float64}, length(strength_vec))
    gradient = zeros(SMatrix{3,3,Float64,9}, length(strength_vec))

    return VortexFilaments(pts, strength_vec, core_size, error_tolerance, potential, force, gradient)
end

function generate_rotor_blade(i_blade=1)
    n_per_blade = length(g1_cw)
    n_blades = 1
    n_filaments = n_per_blade * n_blades
    pts = zeros(SVector{3,Float64}, 2, n_filaments)
    strength_vec = zeros(SVector{3,Float64}, size(pts,2))
    blades = [cwblade1, cwblade2, cwblade3, cwblade4, cwblade5]
    strengths = [g1_cw, g2_cw, g3_cw, g4_cw, g5_cw]
    i_offset = 0
    for i_filament in 1:n_per_blade
        pts[1,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament,:])
        pts[2,i_filament+i_offset] = SVector{3}(blades[i_blade][i_filament+1,:])
        Γ = pts[2,i_filament+i_offset] - pts[1,i_filament+i_offset]
        Γ *= strengths[i_blade][i_filament] / norm(Γ)
        strength_vec[i_filament+i_offset] = Γ
    end

    # create filaments
    core_size = fill(1e-2, size(pts,2))
    error_tolerance = fill(1e-4, size(pts,2))
    potential = zeros(length(strength_vec))
    force = zeros(SVector{3,Float64}, length(strength_vec))
    gradient = zeros(SMatrix{3,3,Float64,9}, length(strength_vec))

    return VortexFilaments(pts, strength_vec, core_size, error_tolerance, potential, force, gradient)
end

